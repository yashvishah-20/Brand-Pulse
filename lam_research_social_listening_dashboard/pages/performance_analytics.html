<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Performance Analytics - Lam Research Social Listening</title>
    <link rel="stylesheet" href="../css/main.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Flamresear9044back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.5"></script>
</head>
<body class="bg-background font-inter">
    <!-- Hover Trigger Zone for Sidebar -->
    <div id="sidebarTrigger" class="fixed left-0 top-0 w-4 h-full z-50 opacity-0 pointer-events-auto"></div>
    
    <!-- Main Container -->
    <div class="flex min-h-screen">
        <!-- Left Sidebar -->
        <aside id="sidebar" class="w-1/4 bg-surface shadow-card border-r border-border-light fixed h-full overflow-y-auto z-40 transition-all duration-300 ease-in-out">
            <!-- Logo Section -->
            <div class="p-6 border-b border-border-light">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-lg font-semibold text-text-primary">Lam Research</h1>
                        <p class="text-sm text-text-secondary">Social Listening</p>
                    </div>
                </div>
            </div>

            <!-- Navigation Menu -->
            <nav class="p-4">
                <!-- Your Company Section -->
                <div class="mb-6">
                    <h3 class="text-sm font-medium text-text-secondary uppercase tracking-wide mb-3">Your Company</h3>
                    <ul class="space-y-1">
                        <li>
                            <a href="dashboard_overview.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                                <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                                </svg>
                                Dashboard Overview
                            </a>
                        </li>
                        <li>
                            <a href="performance_analytics.html" class="flex items-center px-3 py-2 text-sm font-medium text-primary bg-primary-50 rounded-md transition-fast">
                                <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
                                </svg>
                                Performance Analytics
                            </a>
                        </li>
                        <li>
                            <a href="trends_analysis.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                                <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M23 12l-2.44-2.78.34-3.68-3.61-.82-1.89-3.18L12 3 8.6 1.54 6.71 4.72l-3.61.81.34 3.68L1 12l2.44 2.78-.34 3.69 3.61.82 1.89 3.18L12 21l3.4 1.46 1.89-3.18 3.61-.82-.34-3.68L23 12z"/>
                                </svg>
                                Trends Analysis
                            </a>
                        </li>
                        <li>
                            <a href="audience_insights.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                                <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2 2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 8H16c-.8 0-1.54.37-2 1l-3 4v7h2v7h3v-7h1v7h3zM12.5 11.5c.83 0 1.5-.67 1.5-1.5s-.67-1.5-1.5-1.5S11 9.17 11 10s.67 1.5 1.5 1.5zM5.5 6c1.11 0 2-.89 2-2s-.89-2-2-2-2 .89-2 2 .89 2 2 2zm1.5 2h-3C2.67 8 2 8.67 2 10v7h2v7h2v-7h2v7h2v-7h2V10c0-1.33-.67-2-1.5-2z"/>
                                </svg>
                                Audience Insights
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Competitors Company Section -->
                <div>
                    <h3 class="text-sm font-medium text-text-secondary uppercase tracking-wide mb-3">Competitors Company</h3>
                    <ul class="space-y-1">
                        <li>
                            <a href="competitor_analysis.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                                <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M9 11H7v9h2v-9zm4 0h-2v9h2v-9zm4 0h-2v9h2v-9zm2.5-5H18V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v2H4.5c-.83 0-1.5.67-1.5 1.5S3.67 9 4.5 9H6v10c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9h1.5c.83 0 1.5-.67 1.5-1.5S20.33 6 19.5 6zM10 4h4v2h-4V4z"/>
                                </svg>
                                Competitor Analysis
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main id="mainContent" class="flex-1 ml-1/4 p-6 transition-all duration-300 ease-in-out">
            <!-- Breadcrumb Navigation -->
            <nav class="flex mb-6" aria-label="Breadcrumb">
                <ol class="flex items-center space-x-2 text-sm">
                    <li>
                        <span class="text-text-secondary">Your Company</span>
                    </li>
                    <li>
                        <svg class="w-4 h-4 text-text-secondary" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                        </svg>
                    </li>
                    <li>
                        <span class="text-primary font-medium">Performance Analytics</span>
                    </li>
                </ol>
            </nav>

            <!-- Page Header -->
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h1 class="text-3xl font-bold text-text-primary">Performance Analytics</h1>
                    <p class="text-text-secondary mt-1">Detailed sentiment analysis across multiple social media platforms</p>
                </div>
                <div class="flex items-center space-x-3">
                    <button class="px-4 py-2 text-sm font-medium text-text-secondary bg-surface border border-border rounded-md hover:bg-secondary-50 transition-fast">
                        <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        Filter Data
                    </button>
                    <button class="px-4 py-2 text-sm font-medium text-white bg-primary hover:bg-primary-600 rounded-md transition-fast">
                        <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 12v7H5v-7M12 2l-7 7h4v6h6V9h4l-7-7z"/>
                        </svg>
                        Export Charts
                    </button>
                </div>
            </div>

            <!-- Performance Summary (add more space below) -->
            <div class="mt-8 mb-12 bg-surface rounded-lg shadow-card p-6 border border-border-light">
                <h3 class="text-lg font-semibold text-text-primary mb-4">Performance Summary</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-primary" id="avg-negative-sentiment">Loading...</div>
                        <div class="text-sm text-text-secondary">Avg. Negative Sentiment</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-success-600" id="avg-positive-sentiment">Loading...</div>
                        <div class="text-sm text-text-secondary">Avg. Positive Sentiment</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-warning-600" id="avg-neutral-sentiment">Loading...</div>
                        <div class="text-sm text-text-secondary">Avg. Neutral Sentiment</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-info-600" id="top-platform">Loading...</div>
                        <div class="text-sm text-text-secondary">Top Platform</div>
                    </div>
                </div>
            </div>

            <!-- Platform Performance Analytics -->
            <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-semibold text-text-primary">Platform Performance Analysis</h2>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-success-600 rounded-full"></div>
                            <span class="text-sm text-text-secondary">Positive</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-warning-500 rounded-full"></div>
                            <span class="text-sm text-text-secondary">Neutral</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="w-3 h-3 bg-error-500 rounded-full"></div>
                            <span class="text-sm text-text-secondary">Negative</span>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- MarketBeat Chart -->
                    <div class="bg-background rounded-lg p-6 border border-border-light">
                        <div class="text-center mb-4">
                            <h3 class="text-lg font-medium text-text-primary mb-2">MarketBeat</h3>
                            <div class="flex items-center justify-center space-x-4 text-sm text-text-secondary mb-4">
                                <span>Total: 6,247 mentions</span>
                                <span>•</span>
                                <span>Avg. Sentiment: 72%</span>
                            </div>
                        </div>
                        <div class="relative w-64 h-64 mx-auto">
                            <canvas id="marketbeatChart" width="256" height="256"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-3 gap-2 text-center text-sm">
                            <div class="bg-success-50 p-2 rounded">
                                <div class="font-semibold text-success-600">4,374</div>
                                <div class="text-success-600">Positive</div>
                            </div>
                            <div class="bg-warning-50 p-2 rounded">
                                <div class="font-semibold text-warning-600">1,248</div>
                                <div class="text-warning-600">Neutral</div>
                            </div>
                            <div class="bg-error-50 p-2 rounded">
                                <div class="font-semibold text-error-600">625</div>
                                <div class="text-error-600">Negative</div>
                            </div>
                        </div>
                    </div>

                    <!-- Reddit Chart -->
                    <div class="bg-background rounded-lg p-6 border border-border-light">
                        <div class="text-center mb-4">
                            <h3 class="text-lg font-medium text-text-primary mb-2">Reddit</h3>
                            <div class="flex items-center justify-center space-x-4 text-sm text-text-secondary mb-4">
                                <span id="reddit-total">Total: Loading...</span>
                                <span>•</span>
                                <span id="reddit-avg-sentiment">Avg. Sentiment: Loading...</span>
                            </div>
                        </div>
                        <div class="relative w-64 h-64 mx-auto">
                            <canvas id="redditChart" width="256" height="256"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-3 gap-2 text-center text-sm">
                            <div class="bg-success-50 p-2 rounded">
                                <div class="font-semibold text-success-600" id="reddit-positive">-</div>
                                <div class="text-success-600">Positive</div>
                            </div>
                            <div class="bg-warning-50 p-2 rounded">
                                <div class="font-semibold text-warning-600" id="reddit-neutral">-</div>
                                <div class="text-warning-600">Neutral</div>
                            </div>
                            <div class="bg-error-50 p-2 rounded">
                                <div class="font-semibold text-error-600" id="reddit-negative">-</div>
                                <div class="text-error-600">Negative</div>
                            </div>
                        </div>
                    </div>

                    <!-- StockTwits Chart -->
                    <div class="bg-background rounded-lg p-6 border border-border-light">
                        <div class="text-center mb-4">
                            <h3 class="text-lg font-medium text-text-primary mb-2">StockTwits</h3>
                            <div class="flex items-center justify-center space-x-4 text-sm text-text-secondary mb-4">
                                <span id="stocktwits-total">Total: Loading...</span>
                                <span>•</span>
                                <span id="stocktwits-avg-sentiment">Avg. Sentiment: Loading...</span>
                            </div>
                        </div>
                        <div class="relative w-64 h-64 mx-auto">
                            <canvas id="stocktwitsChart" width="256" height="256"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-3 gap-2 text-center text-sm">
                            <div class="bg-success-50 p-2 rounded">
                                <div class="font-semibold text-success-600" id="stocktwits-positive">-</div>
                                <div class="text-success-600">Positive</div>
                            </div>
                            <div class="bg-warning-50 p-2 rounded">
                                <div class="font-semibold text-warning-600" id="stocktwits-neutral">-</div>
                                <div class="text-warning-600">Neutral</div>
                            </div>
                            <div class="bg-error-50 p-2 rounded">
                                <div class="font-semibold text-error-600" id="stocktwits-negative">-</div>
                                <div class="text-error-600">Negative</div>
                            </div>
                        </div>
                    </div>

                    <!-- Twitter Chart -->
                    <div class="bg-background rounded-lg p-6 border border-border-light">
                        <div class="text-center mb-4">
                            <h3 class="text-lg font-medium text-text-primary mb-2">Twitter</h3>
                            <div class="flex items-center justify-center space-x-4 text-sm text-text-secondary mb-4">
                                <span id="twitter-total">Total: Loading...</span>
                                <span>•</span>
                                <span id="twitter-avg-sentiment">Avg. Sentiment: Loading...</span>
                            </div>
                        </div>
                        <div class="relative w-64 h-64 mx-auto">
                            <canvas id="twitterChart" width="256" height="256"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-3 gap-2 text-center text-sm">
                            <div class="bg-success-50 p-2 rounded">
                                <div class="font-semibold text-success-600" id="twitter-positive">-</div>
                                <div class="text-success-600">Positive</div>
                            </div>
                            <div class="bg-warning-50 p-2 rounded">
                                <div class="font-semibold text-warning-600" id="twitter-neutral">-</div>
                                <div class="text-warning-600">Neutral</div>
                            </div>
                            <div class="bg-error-50 p-2 rounded">
                                <div class="font-semibold text-error-600" id="twitter-negative">-</div>
                                <div class="text-error-600">Negative</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Real-time Update Indicator -->
            <div class="mt-6 flex items-center justify-center">
                <div class="flex items-center space-x-2 text-sm text-text-secondary">
                    <div class="w-2 h-2 bg-success-600 rounded-full animate-pulse"></div>
                    <span>Last updated: 3 minutes ago</span>
                    <button class="text-primary hover:text-primary-600 font-medium transition-fast">Refresh Data</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Sidebar Hover Functionality Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const sidebarTrigger = document.getElementById('sidebarTrigger');
            let isHoveringTrigger = false;
            let isHoveringSidebar = false;

            // Function to hide sidebar
            function hideSidebar() {
                sidebar.style.transform = 'translateX(-100%)';
                mainContent.style.marginLeft = '0';
                mainContent.style.width = '100%';
            }

            // Function to show sidebar
            function showSidebar() {
                sidebar.style.transform = 'translateX(0)';
                mainContent.style.marginLeft = '25%';
                mainContent.style.width = '75%';
            }

            // Hide sidebar when hovering over main content
            mainContent.addEventListener('mouseenter', function(e) {
                // Only hide if not hovering over sidebar or trigger
                if (!isHoveringSidebar && !isHoveringTrigger) {
                    hideSidebar();
                }
            });

            // Show sidebar when hovering over trigger zone
            sidebarTrigger.addEventListener('mouseenter', function() {
                isHoveringTrigger = true;
                showSidebar();
            });

            sidebarTrigger.addEventListener('mouseleave', function() {
                isHoveringTrigger = false;
            });

            // Keep sidebar visible when hovering over it
            sidebar.addEventListener('mouseenter', function() {
                isHoveringSidebar = true;
                showSidebar();
            });

            sidebar.addEventListener('mouseleave', function() {
                isHoveringSidebar = false;
                // Hide sidebar if not hovering over trigger
                if (!isHoveringTrigger) {
                    setTimeout(() => {
                        if (!isHoveringTrigger && !isHoveringSidebar) {
                            hideSidebar();
                        }
                    }, 300); // Small delay to prevent flickering
                }
            });

            // Show sidebar when hovering near left edge
            document.addEventListener('mousemove', function(e) {
                if (e.clientX <= 20 && !isHoveringSidebar) {
                    isHoveringTrigger = true;
                    showSidebar();
                } else if (e.clientX > 300 && !isHoveringSidebar) {
                    isHoveringTrigger = false;
                }
            });
        });
    </script>

    <!-- Chart.js Configuration Script -->
    <script>
        // Chart configuration
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        padding: 15,
                        usePointStyle: true,
                        font: {
                            size: 11
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const label = context.label || '';
                            const value = context.parsed;
                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                            const percentage = ((value / total) * 100).toFixed(1);
                            return `${label}: ${value.toLocaleString()} (${percentage}%)`;
                        }
                    }
                }
            },
            onHover: (event, activeElements) => {
                event.native.target.style.cursor = activeElements.length > 0 ? 'pointer' : 'default';
            }
        };

        // MarketBeat Chart (Load data from JSON)
        const marketbeatCtx = document.getElementById('marketbeatChart').getContext('2d');
        let marketbeatChart;
        
        fetch('../public/marketbeat_sentiment.json')
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                console.log('MarketBeat JSON data:', data); // Debug log
                const marketbeatData = [
                    data.Positive || 0,
                    data.Neutral || 0,
                    data.Negative || 0
                ];
                
                // Calculate total mentions
                const totalMentions = marketbeatData.reduce((a, b) => a + b, 0);
                
                // Update MarketBeat display elements
                const marketbeatSection = document.querySelector('.bg-background:has(#marketbeatChart)');
                if (marketbeatSection) {
                    // Update total mentions
                    const totalSpan = marketbeatSection.querySelector('span:first-child');
                    if (totalSpan) {
                        totalSpan.textContent = `Total: ${totalMentions.toLocaleString()} mentions`;
                    }
                    
                    // Update individual sentiment counts
                    const positiveDiv = marketbeatSection.querySelector('.bg-success-50 .font-semibold');
                    const neutralDiv = marketbeatSection.querySelector('.bg-warning-50 .font-semibold');
                    const negativeDiv = marketbeatSection.querySelector('.bg-error-50 .font-semibold');
                    
                    if (positiveDiv) positiveDiv.textContent = data.Positive.toLocaleString();
                    if (neutralDiv) neutralDiv.textContent = data.Neutral.toLocaleString();
                    if (negativeDiv) negativeDiv.textContent = data.Negative.toLocaleString();
                    
                    // Calculate and update average sentiment
                    const avgSentiment = totalMentions > 0 ? ((data.Positive / totalMentions) * 100).toFixed(0) : 0;
                    const avgSentimentSpan = marketbeatSection.querySelector('span:nth-child(3)');
                    if (avgSentimentSpan) {
                        avgSentimentSpan.textContent = `Avg. Sentiment: ${avgSentiment}%`;
                    }
                }
                
                marketbeatChart = new Chart(marketbeatCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: marketbeatData,
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            })
            .catch(error => {
                console.error('Error loading MarketBeat sentiment data:', error);
                // Create chart with default data on error
                marketbeatChart = new Chart(marketbeatCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            });

        // Reddit Chart (Load data from JSON)
        const redditCtx = document.getElementById('redditChart').getContext('2d');
        let redditChart;
        
        fetch('../public/reddit_sentiment.json')
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                console.log('Reddit JSON data:', data); // Debug log
                const redditData = [
                    data.Positive || 0,
                    data.Neutral || 0,
                    data.Negative || 0
                ];
                
                // Calculate total mentions
                const totalMentions = redditData.reduce((a, b) => a + b, 0);
                
                // Update Reddit display elements using IDs
                const totalSpan = document.getElementById('reddit-total');
                const avgSentimentSpan = document.getElementById('reddit-avg-sentiment');
                const positiveDiv = document.getElementById('reddit-positive');
                const neutralDiv = document.getElementById('reddit-neutral');
                const negativeDiv = document.getElementById('reddit-negative');
                
                if (totalSpan) {
                    totalSpan.textContent = `Total: ${totalMentions.toLocaleString()} mentions`;
                }
                
                if (positiveDiv) positiveDiv.textContent = data.Positive.toLocaleString();
                if (neutralDiv) neutralDiv.textContent = data.Neutral.toLocaleString();
                if (negativeDiv) negativeDiv.textContent = data.Negative.toLocaleString();
                
                // Calculate and update average sentiment
                const avgSentiment = totalMentions > 0 ? ((data.Positive / totalMentions) * 100).toFixed(0) : 0;
                if (avgSentimentSpan) {
                    avgSentimentSpan.textContent = `Avg. Sentiment: ${avgSentiment}%`;
                }
                
                redditChart = new Chart(redditCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: redditData,
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            })
            .catch(error => {
                console.error('Error loading Reddit sentiment data:', error);
                // Create chart with default data on error
                redditChart = new Chart(redditCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            });

        // StockTwits Chart (Load data from JSON)
        const stocktwitsCtx = document.getElementById('stocktwitsChart').getContext('2d');
        let stocktwitsChart;
        
        fetch('../public/stocktwits_sentiment.json')
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                console.log('StockTwits JSON data:', data); // Debug log
                const stocktwitsData = [
                    data.Positive || 0,
                    data.Neutral || 0,
                    data.Negative || 0
                ];
                
                // Calculate total mentions
                const totalMentions = stocktwitsData.reduce((a, b) => a + b, 0);
                
                // Update StockTwits display elements using IDs
                const totalSpan = document.getElementById('stocktwits-total');
                const avgSentimentSpan = document.getElementById('stocktwits-avg-sentiment');
                const positiveDiv = document.getElementById('stocktwits-positive');
                const neutralDiv = document.getElementById('stocktwits-neutral');
                const negativeDiv = document.getElementById('stocktwits-negative');
                
                if (totalSpan) {
                    totalSpan.textContent = `Total: ${totalMentions.toLocaleString()} mentions`;
                }
                
                if (positiveDiv) positiveDiv.textContent = data.Positive.toLocaleString();
                if (neutralDiv) neutralDiv.textContent = data.Neutral.toLocaleString();
                if (negativeDiv) negativeDiv.textContent = data.Negative.toLocaleString();
                
                // Calculate and update average sentiment
                const avgSentiment = totalMentions > 0 ? ((data.Positive / totalMentions) * 100).toFixed(0) : 0;
                if (avgSentimentSpan) {
                    avgSentimentSpan.textContent = `Avg. Sentiment: ${avgSentiment}%`;
                }
                
                stocktwitsChart = new Chart(stocktwitsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: stocktwitsData,
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            })
            .catch(error => {
                console.error('Error loading StockTwits sentiment data:', error);
                // Create chart with default data on error
                stocktwitsChart = new Chart(stocktwitsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            });

        // Twitter Chart (Load data from JSON)
        const twitterCtx = document.getElementById('twitterChart').getContext('2d');
        let twitterChart;
        
        fetch('../public/twitter_sentiment.json')
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                console.log('Twitter JSON data:', data); // Debug log
                const twitterData = [
                    data.Positive || 0,
                    data.Neutral || 0,
                    data.Negative || 0
                ];
                
                // Calculate total mentions
                const totalMentions = twitterData.reduce((a, b) => a + b, 0);
                
                // Update Twitter display elements using IDs
                const totalSpan = document.getElementById('twitter-total');
                const avgSentimentSpan = document.getElementById('twitter-avg-sentiment');
                const positiveDiv = document.getElementById('twitter-positive');
                const neutralDiv = document.getElementById('twitter-neutral');
                const negativeDiv = document.getElementById('twitter-negative');
                
                if (totalSpan) {
                    totalSpan.textContent = `Total: ${totalMentions.toLocaleString()} mentions`;
                }
                
                if (positiveDiv) positiveDiv.textContent = data.Positive.toLocaleString();
                if (neutralDiv) neutralDiv.textContent = data.Neutral.toLocaleString();
                if (negativeDiv) negativeDiv.textContent = data.Negative.toLocaleString();
                
                // Calculate and update average sentiment
                const avgSentiment = totalMentions > 0 ? ((data.Positive / totalMentions) * 100).toFixed(0) : 0;
                if (avgSentimentSpan) {
                    avgSentimentSpan.textContent = `Avg. Sentiment: ${avgSentiment}%`;
                }
                
                twitterChart = new Chart(twitterCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: twitterData,
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            })
            .catch(error => {
                console.error('Error loading Twitter sentiment data:', error);
                // Create chart with default data on error
                twitterChart = new Chart(twitterCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Positive', 'Neutral', 'Negative'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                            borderWidth: 3,
                            borderColor: '#FFFFFF',
                            hoverBorderWidth: 4,
                            hoverBackgroundColor: ['#229954', '#E67E22', '#C0392B']
                        }]
                    },
                    options: chartOptions
                });
            });

        // Filter functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Removed date range, sentiment, platform filters, and reset button as requested
        });

        // Update charts function
        function updateCharts() {
            // Simulate loading state
            const charts = [marketbeatChart, redditChart, stocktwitsChart, twitterChart];
            charts.forEach(chart => {
                chart.update('active');
            });
        }

        // Real-time update simulation
        setInterval(() => {
            const updateTime = Array.from(document.querySelectorAll('span')).find(span => 
                span.textContent.includes('Last updated')
            );
            if (updateTime) {
                const now = new Date();
                const minutes = Math.floor(Math.random() * 5) + 1;
                updateTime.textContent = `Last updated: ${minutes} minute${minutes > 1 ? 's' : ''} ago`;
            }
        }, 60000);

        // Export functionality
        const exportButton = Array.from(document.querySelectorAll('button')).find(btn => 
            btn.textContent.trim().includes('Export Charts')
        );
        if (exportButton) {
            exportButton.addEventListener('click', function() {
                // Simulate export functionality
                alert('Charts exported successfully! Download will begin shortly.');
            });
        }
    </script>
    <script>
// Calculate and display average negative sentiment percentage across all platforms
Promise.all([
  fetch('../public/marketbeat_sentiment.json').then(r => r.json()),
  fetch('../public/reddit_sentiment.json').then(r => r.json()),
  fetch('../public/stocktwits_sentiment.json').then(r => r.json()),
  fetch('../public/twitter_sentiment.json').then(r => r.json())
]).then(([marketbeat, reddit, stocktwits, twitter]) => {
  const platforms = [marketbeat, reddit, stocktwits, twitter];
  const percentages = platforms.map(p => {
    const total = p.Positive + p.Neutral + p.Negative;
    return total > 0 ? (p.Negative / total) * 100 : 0;
  });
  const avgNegativePercent = percentages.reduce((sum, val) => sum + val, 0) / percentages.length;
  document.getElementById('avg-negative-sentiment').textContent = avgNegativePercent.toFixed(1) + '%';
}).catch(err => {
  document.getElementById('avg-negative-sentiment').textContent = 'N/A';
  console.error('Failed to load negative sentiment data:', err);
});
// Fetch and display avg positive sentiment from JSON
fetch('../public/avg_positive_sentiment.json')
  .then(response => response.json())
  .then(data => {
    document.getElementById('avg-positive-sentiment').textContent = data.avg_positive_percent.toFixed(1) + '%';
  })
  .catch(err => {
    document.getElementById('avg-positive-sentiment').textContent = 'N/A';
    console.error('Failed to load avg positive sentiment:', err);
  });
// Fetch and display avg neutral sentiment from JSON
fetch('../public/avg_neutral_sentiment.json')
  .then(response => response.json())
  .then(data => {
    document.getElementById('avg-neutral-sentiment').textContent = data.avg_neutral_percent.toFixed(1) + '%';
  })
  .catch(err => {
    document.getElementById('avg-neutral-sentiment').textContent = 'N/A';
    console.error('Failed to load avg neutral sentiment:', err);
  });
// Fetch and display top platform from JSON
fetch('../public/top_platform.json')
  .then(response => response.json())
  .then(data => {
    document.getElementById('top-platform').textContent = data.platform;
  })
  .catch(err => {
    document.getElementById('top-platform').textContent = 'N/A';
    console.error('Failed to load top platform:', err);
  });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>