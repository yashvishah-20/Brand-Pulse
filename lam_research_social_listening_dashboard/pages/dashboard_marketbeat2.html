<!DOCTYPE html>
<html lang="en">
<head>
   <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M3PJQD2C');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MarketBeat Overview - Lam Research Social Listening</title>
    <link rel="stylesheet" href="../css/main.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
  .active-platform {
    box-shadow: 0 0 0 4px #ff7300, 0 4px 16px rgba(255, 115, 0, 0.25);
    border-radius: 12px;
    outline: none;
    z-index: 1;
    transition: box-shadow 0.2s;
  }
</style>
</head>
   
<body class="bg-background font-inter">
   <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M3PJQD2C"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <!-- Logo at the top, acts as a back button -->
    <a href="dashboard_overview2.html" style="text-decoration: none;">
      <div style="display: flex; align-items: center; margin-bottom: 12px; cursor: pointer;">
        <img src="../../prowess logo.png" alt="Prowess Logo" style="width: 200px; height: 100px; object-fit: contain;">
      </div>
    </a>
    <div class="flex min-h-screen">
        <!-- Sidebar (add if needed) -->
        <!-- ... -->
        <main id="mainContent" class="flex-1 ml-1/4 p-6 transition-all duration-300 ease-in-out">
            <!-- Filter Bar -->
            <div class="flex flex-wrap items-center justify-between gap-4 bg-surface rounded-lg shadow-card p-4 border border-border-light mb-6">
                <!-- Facebook -->
                <a href="dashboard_facebook2.html" class="platform-btn" title="Facebook" aria-label="Facebook">
                    <img src="../public/facebook.png" alt="Facebook" style="width:40px; height:40px;">
                </a>
                <!-- X -->
                <a href="dashboard_x2.html" class="platform-btn" title="X" aria-label="X">
                    <img src="../public/x.png" alt="X" style="width:40px; height:40px;">
                </a>
                <!-- Instagram -->
                <a href="dashboard_instagram2.html" class="platform-btn" title="Instagram" aria-label="Instagram">
                    <img src="../public/instagram.png" alt="Instagram" style="width:40px; height:40px;">
                </a>
                <!-- Reddit -->
                <a href="dashboard_reddit2.html" class="platform-btn" title="Reddit" aria-label="Reddit">
                    <img src="../public/reddit.png" alt="Reddit" style="width:40px; height:40px;">
                </a>
                <!-- MarketBeat -->
                <a href="dashboard_marketbeat2.html" class="platform-btn" title="MarketBeat" aria-label="MarketBeat">
                    <img src="../public/marketbeat.png" alt="MarketBeat" style="width:40px; height:40px;">
                </a>
                <!-- Glassdoor -->
                <a href="dashboard_glassdoor2.html" class="platform-btn" title="Glassdoor" aria-label="Glassdoor">
                    <img src="../public/glassdoor.png" alt="Glassdoor" style="width:40px; height:40px;">
                </a>
                <!-- StockTwits -->
                <a href="dashboard_stocktwits2.html" class="platform-btn" title="StockTwits" aria-label="StockTwits">
                    <img src="../public/stocktwits.png" alt="StockTwits" style="width:40px; height:40px;">
                </a>
                <!-- LinkedIn -->
                <a href="dashboard_linkedin2.html" class="platform-btn" title="LinkedIn" aria-label="LinkedIn">
                    <img src="../public/linkedin.png" alt="LinkedIn" style="width:40px; height:40px;">
                </a>
            </div>
            <!-- Summary Cards -->
            <div id="dashboardSummaryCards" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <!-- Total Volume Card -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-text-secondary">Total Volume</p>
                            <p class="text-2xl font-bold text-text-primary mt-1" id="total-volume">2,485</p>
                            <p class="text-sm text-success-600 mt-1">
                                <span class="inline-flex items-center">
                                    <svg class="w-4 h-4 text-success-600 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M7 10l5 5 5-5z"/>
                                    </svg>
                                    <span class="font-bold">+8%</span>
                                </span>
                                <span class="block">increased by 8% from last year</span>
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-accent-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <!-- Total Engagements Card -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-text-secondary">Total Engagements</p>
                            <p class="text-2xl font-bold text-text-primary mt-1" id="engagement-rate">1,024</p>
                            <p class="text-sm text-text-secondary mt-1">All sentiment mentions (measures direct news engagement and sentiment analysis)</p>
                        </div>
                        <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-accent-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <!-- Sentiment Trends Card (Glassdoor style) -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-text-secondary">Sentiment Trends</p>
                            <div class="mt-2 space-y-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-text-secondary">Positive:</span>
                                    <span class="text-sm font-semibold text-success-600">â†— +5.2%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-text-secondary">Neutral:</span>
                                    <span class="text-sm font-semibold text-warning-500">â†˜ -2.1%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm text-text-secondary">Negative:</span>
                                    <span class="text-sm font-semibold text-error-500">â†˜ -3.1%</span>
                                </div>
                            </div>
                        </div>
                        <div class="w-12 h-12 bg-success-100 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-success-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <!-- MarketBeat Overview Title -->
            <h2 class="text-2xl font-bold mb-4">MarketBeat Overview</h2>
            <!-- Tab Bar -->
            <div class="flex gap-4 mb-8">
               <!-- <button id="showEngagement" class="flex-1 px-6 py-3 text-lg font-semibold text-white bg-primary rounded-md shadow">Engagement</button> -->
                <!-- <button id="showTrends" class="flex-1 px-6 py-3 text-lg font-semibold text-primary border-2 border-primary rounded-md shadow">Trends</button> -->
            </div>
            <div id="performanceView">
                <!-- MarketBeat Engagement Charts (from Audience Insights) -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-text-primary">Yearly Sentiment Analysis</h3>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-success-600 rounded-full"></div>
                                <span class="text-sm text-text-secondary">Positive</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-warning-500 rounded-full"></div>
                                <span class="text-sm text-text-secondary">Neutral</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-error-500 rounded-full"></div>
                                <span class="text-sm text-text-secondary">Negative</span>
                            </div>
                        </div>
                    </div>
                    <div class="relative h-96">
                        <canvas id="marketbeatBarChart" width="800" height="384"></canvas>
                    </div>
                    <div class="mt-6 grid grid-cols-3 gap-4 text-center">
                        <div>
                            <p id="marketbeatPositive" class="text-2xl font-bold text-success-600">...</p>
                            <p class="text-sm text-text-secondary">Positive Sentiment</p>
                        </div>
                        <div>
                            <p id="marketbeatNeutral" class="text-2xl font-bold text-warning-500">...</p>
                            <p class="text-sm text-text-secondary">Neutral Sentiment</p>
                        </div>
                        <div>
                            <p id="marketbeatNegative" class="text-2xl font-bold text-error-500">...</p>
                            <p class="text-sm text-text-secondary">Negative Sentiment</p>
                        </div>
                    </div>
                </div>
                
                <!-- MarketBeat Sentiment Trends Over Time (moved from Trends tab) -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h2 class="text-xl font-semibold text-text-primary">Sentiment Trends Over Time</h2>
                            <p id="marketbeatTrendsSubtitle" class="text-sm text-text-secondary mt-1">MarketBeat - Last 12 Months</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-success-600 rounded-full"></div>
                                <span class="text-sm text-text-secondary">Positive</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-warning-500 rounded-full"></div>
                                <span class="text-sm text-text-secondary">Neutral</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-error-500 rounded-full"></div>
                                <span class="text-sm text-text-secondary">Negative</span>
                            </div>
                        </div>
                    </div>
                    <!-- Time Range Slider -->
                    <div class="flex items-center mb-4">
                        <span class="mr-2 text-gray-500 font-medium">Range:</span>
                        <span id="marketbeatSliderLabel6m" class="text-gray-500" style="min-width: 2.5em;">6m</span>
                        <input
                            type="range"
                            id="marketbeatTrendRangeSlider"
                            min="0"
                            max="2"
                            step="1"
                            value="1"
                            style="accent-color: #ff7300; width: 180px; margin: 0 10px; background: transparent;"
                        />
                        <span id="marketbeatSliderLabel2y" class="text-gray-500" style="min-width: 2.5em;">2y</span>
                        <span id="marketbeatSliderRangeBadge" class="ml-3 px-3 py-1 rounded-xl" style="background: #ffe5d0; color: #c2410c; font-weight: 600; font-size: 1.2em;">1y</span>
                    </div>
                    <div class="relative h-96">
                        <canvas id="marketbeatTrendsChart" class="w-full h-full"></canvas>
                    </div>
                </div>
                
                <!-- MarketBeat Activity Radar by Month -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light mt-8">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-text-primary">MarketBeat Activity Radar (by Month)</h3>
                        <div>
                            <select id="marketbeatRadarYearSelect" class="appearance-none bg-surface border border-border rounded-md px-4 py-2 pr-8 text-sm font-medium text-text-primary focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                <option value="all">All Years</option>
                            </select>
                        </div>
                    </div>
                    <div class="relative h-96 flex items-center justify-center">
                        <canvas id="marketbeatRadarChart" width="400" height="384"></canvas>
                    </div>
                </div>
                <!-- MarketBeat Summary Insights -->
                
            <div id="trendsView" class="hidden">
                <!-- (REMOVED: Sentiment Trends Over Time chart moved to Engagement tab) -->

                <!-- Key Insights & Patterns Section -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                    <h3 class="text-lg font-semibold text-text-primary mb-4">MarketBeat Trend Insights</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-sm font-medium text-text-secondary mb-3">Trending Patterns</h4>
                            <ul class="space-y-2" id="trendingPatterns">
                                <li class="flex items-start space-x-2">
                                    <span class="inline-block w-3 h-3 rounded-full bg-green-500 mt-1"></span>
                                    <div>
                                        <span class="font-medium" id="pattern1">Loading...</span><br/>
                                        <span class="text-text-secondary text-sm" id="pattern1Detail">Analyzing patterns...</span>
                                    </div>
                                </li>
                                <li class="flex items-start space-x-2">
                                    <span class="inline-block w-3 h-3 rounded-full bg-blue-500 mt-1"></span>
                                    <div>
                                        <span class="font-medium" id="pattern2">Professional investor focus</span><br/>
                                        <span class="text-text-secondary text-sm" id="pattern2Detail">MarketBeat sentiment reflects institutional perspective</span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-sm font-medium text-text-secondary mb-3">Key Metrics</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-text-primary">Average Sentiment</span>
                                    <span class="text-sm font-medium text-text-primary" id="avgSentimentTrends">Loading...</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-text-primary">Trend Direction</span>
                                    <span class="text-sm font-medium" id="trendDirectionTrends">Loading...</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-sm text-text-primary">Data Points</span>
                                    <span class="text-sm font-medium text-text-primary" id="dataPointsCount">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script>
    // Global variables
    let marketbeatTrendsChart = null;
    let marketbeatTrendsData = null;

    // MarketBeat Bar Chart
    function initializeMarketBeatChart() {
        const ctx = document.getElementById('marketbeatBarChart');
        if (!ctx) return;

        fetch('../public/marketbeat_trends.json')
            .then(response => response.json())
            .then(data => {
                // Store data for trends chart
                marketbeatTrendsData = data;
                
                // Aggregate data by year
                const yearMap = {};
                data.labels.forEach((label, idx) => {
                    const year = label.split(' ')[1];
                    if (!yearMap[year]) {
                        yearMap[year] = { positive: [], neutral: [], negative: [] };
                    }
                    yearMap[year].positive.push(data.positive[idx]);
                    yearMap[year].neutral.push(data.neutral[idx]);
                    yearMap[year].negative.push(data.negative[idx]);
                });
                const years = Object.keys(yearMap);
                const positiveYearly = years.map(y => {
                    const arr = yearMap[y].positive;
                    return arr.reduce((a, b) => a + b, 0) / arr.length;
                });
                const neutralYearly = years.map(y => {
                    const arr = yearMap[y].neutral;
                    return arr.reduce((a, b) => a + b, 0) / arr.length;
                });
                const negativeYearly = years.map(y => {
                    const arr = yearMap[y].negative;
                    return arr.reduce((a, b) => a + b, 0) / arr.length;
                });
                new Chart(ctx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: years,
                        datasets: [
                            {
                                label: 'Positive',
                                data: positiveYearly,
                                backgroundColor: '#27AE60',
                                borderRadius: 4
                            },
                            {
                                label: 'Neutral',
                                data: neutralYearly,
                                backgroundColor: '#F39C12',
                                borderRadius: 4
                            },
                            {
                                label: 'Negative',
                                data: negativeYearly,
                                backgroundColor: '#E74C3C',
                                borderRadius: 4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: { display: false },
                                ticks: { font: { size: 12 } }
                            },
                            y: {
                                beginAtZero: true,
                                grid: { color: '#F3F4F6' },
                                ticks: { font: { size: 12 },
                                    callback: function(value) { return value + '%'; }
                                },
                                max: 100
                            }
                        }
                    }
                });

                // Set the latest year's sentiment values in the summary below the chart
                const lastIdx = years.length - 1;
                const pos = positiveYearly[lastIdx];
                const neu = neutralYearly[lastIdx];
                const neg = negativeYearly[lastIdx];
                const posEl = document.getElementById('marketbeatPositive');
                const neuEl = document.getElementById('marketbeatNeutral');
                const negEl = document.getElementById('marketbeatNegative');
                if (posEl) posEl.textContent = pos ? pos.toFixed(1) + '%' : 'N/A';
                if (neuEl) neuEl.textContent = neu ? neu.toFixed(1) + '%' : 'N/A';
                if (negEl) negEl.textContent = neg ? neg.toFixed(1) + '%' : 'N/A';
                
                // Generate summary insights
                generateSentimentSummary(pos, neu, neg, positiveYearly, neutralYearly, negativeYearly);

                // AUTOMATION: Initialize the Sentiment Trends Over Time chart after data loads
                initializeMarketBeatTrendsChart();
            })
            .catch(error => {
                console.error('Error loading MarketBeat trends data:', error);
            });
    }

    // --- AUTOMATION: Sentiment Trends Over Time Chart with Slider ---
    function updateMarketbeatTrendsChartForRange(rangeIndex) {
        if (!marketbeatTrendsData) return;
        let months, badge, subtitle;
        if (rangeIndex == 0) { months = 6; badge = "6m"; subtitle = "MarketBeat - Last 6 Months"; }
        else if (rangeIndex == 1) { months = 12; badge = "1y"; subtitle = "MarketBeat - Last 12 Months"; }
        else { months = 24; badge = "2y"; subtitle = "MarketBeat - Last 24 Months"; }
        const total = marketbeatTrendsData.labels.length;
        const start = Math.max(0, total - months);
        const labels = marketbeatTrendsData.labels.slice(start);
        const positive = marketbeatTrendsData.positive.slice(start);
        const neutral = marketbeatTrendsData.neutral.slice(start);
        const negative = marketbeatTrendsData.negative.slice(start);
        if (marketbeatTrendsChart) marketbeatTrendsChart.destroy();
        const ctx = document.getElementById('marketbeatTrendsChart');
        marketbeatTrendsChart = new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    { label: 'Positive', data: positive, borderColor: '#27AE60', backgroundColor: 'rgba(39, 174, 96, 0.1)', borderWidth: 3, fill: true, tension: 0.4, pointBackgroundColor: '#27AE60', pointBorderColor: '#FFFFFF', pointBorderWidth: 2, pointRadius: 4, pointHoverRadius: 6 },
                    { label: 'Neutral', data: neutral, borderColor: '#F39C12', backgroundColor: 'rgba(243, 156, 18, 0.1)', borderWidth: 3, fill: true, tension: 0.4, pointBackgroundColor: '#F39C12', pointBorderColor: '#FFFFFF', pointBorderWidth: 2, pointRadius: 4, pointHoverRadius: 6 },
                    { label: 'Negative', data: negative, borderColor: '#E74C3C', backgroundColor: 'rgba(231, 76, 60, 0.1)', borderWidth: 3, fill: true, tension: 0.4, pointBackgroundColor: '#E74C3C', pointBorderColor: '#FFFFFF', pointBorderWidth: 2, pointRadius: 4, pointHoverRadius: 6 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: {
                    intersect: false,
                    mode: 'index'
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(255, 255, 255, 0.95)',
                        titleColor: '#2C3E50',
                        bodyColor: '#2C3E50',
                        borderColor: '#E1E8ED',
                        borderWidth: 1,
                        cornerRadius: 8,
                        displayColors: true,
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${context.parsed.y}%`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { display: true, color: '#F3F4F6' },
                        ticks: { color: '#6B7280', font: { size: 12 } }
                    },
                    y: {
                        beginAtZero: true,
                        max: 100,
                        grid: { display: true, color: '#F3F4F6' },
                        ticks: { color: '#6B7280', font: { size: 12 }, callback: function(value) { return value + '%'; } }
                    }
                }
            }
        });
        // Update badge and subtitle
        document.getElementById('marketbeatSliderRangeBadge').textContent = badge;
        document.getElementById('marketbeatTrendsSubtitle').textContent = subtitle;
    }

    function initializeMarketBeatTrendsChart() {
        const slider = document.getElementById('marketbeatTrendRangeSlider');
        const rangeIndex = slider ? Number(slider.value) : 1;
        updateMarketbeatTrendsChartForRange(rangeIndex);
    }

    // Update trends insights
    function updateTrendsInsights() {
        if (!marketbeatTrendsData) return;
        
        const data = marketbeatTrendsData;
        const avgPositive = (data.positive.reduce((a, b) => a + b, 0) / data.positive.length).toFixed(1);
        const recentTrend = data.positive.length > 3 ? 
            data.positive.slice(-3).reduce((a, b) => a + b, 0) / 3 : avgPositive;
        const isImproving = recentTrend > avgPositive;
        
        // Update pattern analysis
        const pattern1El = document.getElementById('pattern1');
        const pattern1DetailEl = document.getElementById('pattern1Detail');
        if (pattern1El && pattern1DetailEl) {
            pattern1El.textContent = isImproving ? 'Positive sentiment surge detected' : 'Sentiment stabilization observed';
            pattern1DetailEl.textContent = `${avgPositive}% average positive sentiment across ${data.labels.length} data points`;
        }
        
        // Update metrics
        const avgSentimentEl = document.getElementById('avgSentimentTrends');
        const trendDirectionEl = document.getElementById('trendDirectionTrends');
        const dataPointsEl = document.getElementById('dataPointsCount');
        
        if (avgSentimentEl) avgSentimentEl.textContent = `${avgPositive}%`;
        if (trendDirectionEl) {
            trendDirectionEl.textContent = isImproving ? 'â†— Improving' : 'â†˜ Stable';
            trendDirectionEl.className = isImproving ? 'text-sm font-medium text-success-600' : 'text-sm font-medium text-warning-600';
        }
        if (dataPointsEl) dataPointsEl.textContent = `${data.labels.length} months`;
    }

    // Generate sentiment summary and insights
    function generateSentimentSummary(currentPos, currentNeu, currentNeg, posHistory, neuHistory, negHistory) {
        const summaryTextEl = document.getElementById('sentimentSummaryText');
        const trendDirectionEl = document.getElementById('trendDirection');
        const recommendationEl = document.getElementById('recommendation');
        const positiveImpactEl = document.getElementById('positiveImpact');
        const neutralImpactEl = document.getElementById('neutralImpact');
        const negativeImpactEl = document.getElementById('negativeImpact');

        // Calculate trends (comparing current to previous year)
        const prevPos = posHistory[posHistory.length - 2] || 0;
        const prevNeu = neuHistory[neuHistory.length - 2] || 0;
        const prevNeg = negHistory[negHistory.length - 2] || 0;

        const posChange = currentPos - prevPos;
        const neuChange = currentNeu - prevNeu;
        const negChange = currentNeg - prevNeg;

        // Generate summary text
        let summaryText = "";
        if (currentPos > currentNeg && currentPos > currentNeu) {
            summaryText = `MarketBeat sentiment is predominantly positive at ${currentPos.toFixed(1)}%, indicating strong market confidence in Lam Research. `;
        } else if (currentNeg > currentPos && currentNeg > currentNeu) {
            summaryText = `MarketBeat sentiment shows concerns with ${currentNeg.toFixed(1)}% negative sentiment, suggesting market uncertainty about Lam Research. `;
        } else {
            summaryText = `MarketBeat sentiment is balanced with ${currentNeu.toFixed(1)}% neutral sentiment, indicating a wait-and-see market approach. `;
        }

        if (Math.abs(posChange) > 5) {
            summaryText += posChange > 0 ? 
                `Positive sentiment has increased by ${posChange.toFixed(1)}% year-over-year.` : 
                `Positive sentiment has decreased by ${Math.abs(posChange).toFixed(1)}% year-over-year.`;
        }

        // Generate trend direction
        let trendText = "";
        if (posChange > 2) {
            trendText = "ðŸ“ˆ Improving - Positive sentiment trending upward";
        } else if (posChange < -2) {
            trendText = "ðŸ“‰ Declining - Positive sentiment trending downward";
        } else {
            trendText = "âž¡ï¸ Stable - Sentiment remains relatively consistent";
        }

        // Generate recommendations
        let recText = "";
        if (currentPos > 60) {
            recText = "Continue current communication strategy - sentiment is strong";
        } else if (currentNeg > 40) {
            recText = "Focus on addressing market concerns and improving investor confidence";
        } else {
            recText = "Engage more actively with financial media to boost positive sentiment";
        }

        // Update impact descriptions
        let posImpact = currentPos > 50 ? "Strong market confidence" : "Moderate investor interest";
        let neuImpact = currentNeu > 40 ? "High information-seeking behavior" : "Standard engagement levels";
        let negImpact = currentNeg > 30 ? "Significant concerns present" : "Minimal negative perception";

        // Update DOM elements
        if (summaryTextEl) summaryTextEl.textContent = summaryText;
        if (trendDirectionEl) trendDirectionEl.textContent = trendText;
        if (recommendationEl) recommendationEl.textContent = recText;
        if (positiveImpactEl) positiveImpactEl.textContent = posImpact;
        if (neutralImpactEl) neutralImpactEl.textContent = neuImpact;
        if (negativeImpactEl) negativeImpactEl.textContent = negImpact;
    }

    // Tab functionality
    const showEngagement = document.getElementById('showEngagement');
    const showTrends = document.getElementById('showTrends');
    const performanceView = document.getElementById('performanceView');
    const trendsView = document.getElementById('trendsView');
    
    // MarketBeat Engagement Charts Logic (from Audience Insights)
    let marketbeatRadarChart = null;
    let marketbeatRadarRawData = null;
    async function loadMarketbeatRadarChart() {
        try {
            const response = await fetch('../public/marketbeat_activity_radar.json');
            if (!response.ok) throw new Error('Failed to load marketbeat_activity_radar.json');
            const data = await response.json();
            marketbeatRadarRawData = data;
            const yearSelect = document.getElementById('marketbeatRadarYearSelect');
            if (yearSelect) {
                // Extract years from labels (format: 'Month YYYY')
                const years = Array.from(new Set(data.labels.map(label => label.split(' ')[1])));
                yearSelect.innerHTML = '<option value="all">All Years</option>' + years.map(y => `<option value="${y}">${y}</option>`).join('');
                yearSelect.onchange = function() { renderMarketbeatRadarChart(this.value); };
            }
            renderMarketbeatRadarChart('all');
        } catch (e) {
            const ctx = document.getElementById('marketbeatRadarChart');
            if (ctx) {
                ctx.parentNode.innerHTML = '<div class="text-center text-warning-700">Unable to load MarketBeat radar chart data.</div>';
            }
        }
    }
    function renderMarketbeatRadarChart(selectedYear) {
        const ctx = document.getElementById('marketbeatRadarChart');
        if (!ctx || !marketbeatRadarRawData) return;
        if (marketbeatRadarChart) marketbeatRadarChart.destroy();
        let labels = marketbeatRadarRawData.labels;
        let values = marketbeatRadarRawData.values;
        if (selectedYear && selectedYear !== 'all') {
            labels = marketbeatRadarRawData.labels.filter(l => l.endsWith(' ' + selectedYear));
            values = labels.map(l => {
                const idx = marketbeatRadarRawData.labels.indexOf(l);
                return marketbeatRadarRawData.values[idx];
            });
        }
        marketbeatRadarChart = new Chart(ctx.getContext('2d'), {
            type: 'radar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Mentions by Month',
                    data: values,
                    fill: true,
                    backgroundColor: 'rgba(39, 174, 96, 0.2)',
                    borderColor: '#27AE60',
                    pointBackgroundColor: '#27AE60',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#27AE60',
                    borderWidth: 3,
                    pointRadius: 6,
                    pointHoverRadius: 9
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: {
                            color: '#27AE60',
                            font: { weight: 'bold' }
                        }
                    },
                    tooltip: {
                        enabled: true,
                        backgroundColor: '#1F2937',
                        titleColor: '#FFFFFF',
                        bodyColor: '#FFFFFF',
                        borderColor: '#374151',
                    }
                },
                scales: {
                    r: {
                        angleLines: { color: '#E5E7EB' },
                        grid: { color: '#E5E7EB' },
                        pointLabels: { color: '#27AE60', font: { weight: 'bold' } },
                        ticks: { color: '#374151' }
                    }
                },
                animation: {
                    duration: 1200,
                    easing: 'easeInOutQuart'
                },
                interaction: {
                    intersect: false,
                    mode: 'nearest'
                }
            }
        });
    }
    // Engagement tab initialization
    
    // Engagement tab initialization
if (showEngagement && showTrends && performanceView && trendsView) {
    showEngagement.onclick = function() {
        performanceView.classList.remove('hidden');
        trendsView.classList.add('hidden');
        showEngagement.classList.add('bg-primary', 'text-white');
        showEngagement.classList.remove('text-primary', 'border-2', 'border-primary');
        showTrends.classList.remove('bg-primary', 'text-white');
        showTrends.classList.add('text-primary', 'border-2', 'border-primary');
        
        // Initialize MarketBeat engagement charts
        initializeMarketBeatChart();
        loadMarketbeatRadarChart();
    };

    showTrends.onclick = function() {
        trendsView.classList.remove('hidden');
        performanceView.classList.add('hidden');
        showTrends.classList.add('bg-primary', 'text-white');
        showTrends.classList.remove('text-primary', 'border-2', 'border-primary');
        showEngagement.classList.remove('bg-primary', 'text-white');
        showEngagement.classList.add('text-primary', 'border-2', 'border-primary');

        // Initialize trends chart when trends tab is shown
        if (marketbeatTrendsData) {
            initializeMarketBeatTrendsChart();
        }
    };

    // Set Engagement as default if tabs are present
    performanceView.classList.remove('hidden');
    trendsView.classList.add('hidden');
    showEngagement.classList.add('bg-primary', 'text-white');
    showEngagement.classList.remove('text-primary', 'border-2', 'border-primary');
    showTrends.classList.remove('bg-primary', 'text-white');
    showTrends.classList.add('text-primary', 'border-2', 'border-primary');
}

// âœ… Always load charts on page load, even if buttons are missing
initializeMarketBeatChart();
loadMarketbeatRadarChart();

    document.addEventListener('DOMContentLoaded', function() {
    // Attach slider event for Sentiment Trends Over Time
    const slider = document.getElementById('marketbeatTrendRangeSlider');
    if (slider) {
        slider.addEventListener('input', function() {
            updateMarketbeatTrendsChartForRange(Number(this.value));
        });
    }

    // Platform highlighting
    const platformBtns = document.querySelectorAll('.platform-btn');
    const currentPage = window.location.pathname.split('/').pop();
    platformBtns.forEach(btn => {
      const href = btn.getAttribute('href');
      if (href && href === currentPage) {
        btn.classList.add('active-platform');
      }
    });
  });
    </script>
</body>
</html> 



