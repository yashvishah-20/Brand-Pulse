<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>X Overview - Prowess Social Listening</title>
    <link rel="stylesheet" href="../css/main.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-background font-inter">
    <!-- Ultra-narrow hover trigger zone for sidebar (reduced from 50px) -->
    <div id="sidebarTrigger" style="position: fixed; left: 0; top: 0; width: 10px; height: 100vh; z-index: 50; background: transparent; cursor: default;"></div>
    
    <!-- Sidebar Navigation -->
    <aside id="sidebar" class="w-1/4 bg-surface shadow-card border-r border-border-light fixed h-full overflow-y-auto z-40 transition-all duration-300 ease-in-out" style="transform: translateX(-100%);">
        <!-- Logo Section -->
        <div class="p-6 border-b border-border-light">
            <a href="dashboard_overview.html" style="text-decoration: none;">
              <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 12px; cursor: pointer;">
                <img src="../../prowess logo.png" alt="Prowess Logo" style="width: 200px; height: 100px; object-fit: contain;">
              </div>
            </a>
        </div>

        <!-- Navigation Menu -->
        <nav class="p-4">
            <!-- Your Company Section -->
            <div class="mb-6">
                <h3 class="text-sm font-medium text-text-secondary uppercase tracking-wide mb-3">Your Company</h3>
                <ul class="space-y-1">
                    <li>
                        <a href="dashboard_overview.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                            <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                            </svg>
                            Sentiment
                        </a>
                    </li>
                    <li>
                        <a href="dashboard_facebook2.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                            <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                            Engagement
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Competitors Company Section -->
            <div>
                <h3 class="text-sm font-medium text-text-secondary uppercase tracking-wide mb-3">Competitors Company</h3>
                <ul class="space-y-1">
                    <li>
                        <a href="competitor_analysis.html" class="flex items-center px-3 py-2 text-sm font-medium text-text-secondary hover:text-text-primary hover:bg-secondary-50 rounded-md transition-fast">
                            <svg class="w-4 h-4 mr-3" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M9 11H7v9h2v-9zm4 0h-2v9h2v-9zm4 0h-2v9h2v-9zm2.5-5H18V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v2H4.5c-.83 0-1.5.67-1.5 1.5S3.67 9 4.5 9H6v10c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9h1.5c.83 0 1.5-.67 1.5-1.5S20.33 6 19.5 6zM10 4h4v2h-4V4z"/>
                            </svg>
                            Competitor Analysis
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </aside>

    <!-- Main Content Area -->
    <main id="mainContent" class="flex-1 ml-1/4 p-6 transition-all duration-300 ease-in-out">
        <!-- Header Section with Logo and Date Filter -->
        <div class="flex items-center justify-between mb-6">
            <!-- Left side - Logo -->
            <div class="flex items-center">
                <a href="dashboard_overview.html" style="text-decoration: none;">
                    <div style="display: flex; align-items: center; cursor: pointer;">
                        <img src="../../prowess logo.png" alt="Prowess Logo" style="width: 200px; height: 100px; object-fit: contain;">
                    </div>
                </a>
            </div>
            
            <!-- Right side - Date Filter -->
            <div class="flex items-center space-x-4">
                <!-- Date Range Filter -->
                <div class="flex items-center space-x-3 bg-surface rounded-lg shadow-card p-3 border border-border-light">
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-text-secondary">FROM:</label>
                        <input type="date" id="dateFrom" class="px-3 py-2 text-sm border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white" value="2024-01-01">
                    </div>
                    <div class="text-text-secondary">—</div>
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-text-secondary">TO:</label>
                        <input type="date" id="dateTo" class="px-3 py-2 text-sm border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white" value="2024-12-31">
                    </div>
                    <button id="applyDateFilter" class="px-4 py-2 text-sm font-medium text-white bg-primary rounded-md hover:bg-primary-600 transition-fast flex items-center">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                        Apply
                    </button>
                </div>
                <!-- Export Report Button -->
                <a href="../public/competitor_analysis_data.zip" download class="px-4 py-2 text-sm font-medium text-text-secondary bg-surface border border-border rounded-md hover:bg-secondary-50 transition-fast flex items-center">
                    <svg class="w-4 h-4 inline mr-2" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M5 20h14v-2H5v2zm7-18v12m0 0l-4-4m4 4l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    Export Report
                </a>
            </div>
        </div>
            <!-- Filter Bar -->
            <div class="flex flex-wrap items-center justify-between gap-4 bg-surface rounded-lg shadow-card p-4 border border-border-light mb-6">
                <!-- Facebook -->
                <a href="dashboard_facebook2.html" class="platform-btn" title="Facebook" aria-label="Facebook">
                    <img src="../public/facebook.png" alt="Facebook" style="width:40px; height:40px;">
                </a>
                <!-- X -->
                <a href="dashboard_x2.html" class="platform-btn" title="X" aria-label="X">
                    <img src="../public/x.png" alt="X" style="width:40px; height:40px;">
                </a>
                <!-- Instagram -->
                <a href="dashboard_instagram2.html" class="platform-btn" title="Instagram" aria-label="Instagram">
                    <img src="../public/instagram.png" alt="Instagram" style="width:40px; height:40px;">
                </a>
                <!-- Reddit -->
                <a href="dashboard_reddit2.html" class="platform-btn" title="Reddit" aria-label="Reddit">
                    <img src="../public/reddit.png" alt="Reddit" style="width:40px; height:40px;">
                </a>
                <!-- LinkedIn -->
                <a href="dashboard_linkedin2.html" class="platform-btn" title="LinkedIn" aria-label="LinkedIn">
                    <img src="../public/linkedin.png" alt="LinkedIn" style="width:40px; height:40px;">
                </a>
            </div>
            <!-- X header removed per request -->

            <!-- Platform Performance Metrics -->
            <div id="dashboardSummaryCards" class="flex flex-row gap-2 mb-8" style="flex-wrap: nowrap;">
                <!-- Reach & Visibility -->
                <div class="flex-1 bg-surface rounded-lg shadow-card p-3 border border-border-light" style="flex: 1 1 20%; min-width: 0;">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h4 class="text-xs font-medium text-text-secondary mb-1">Reach & Visibility</h4>
                            <p id="reachValue" class="text-lg font-bold text-text-primary mb-2">1.8M</p>
                            <div class="flex items-center">
                                <span id="reachChange" style="background:none;color:#16a34a;" class="inline-flex items-center text-xs font-medium">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    +12.3% vs last month
                                </span>
                            </div>
                        </div>
                        <div class="w-8 h-8 bg-primary-100 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-primary-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Engagement Rate -->
                <div class="flex-1 bg-surface rounded-lg shadow-card p-3 border border-border-light" style="flex: 1 1 20%; min-width: 0;">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h4 class="text-xs font-medium text-text-secondary mb-1">Engagement Rate (Avg.)</h4>
                            <p id="performanceValue" class="text-lg font-bold text-text-primary mb-2">4.2%</p>
                            <div class="flex items-center">
                                <span id="engagementChange" style="background:none;color:#16a34a;" class="inline-flex items-center text-xs font-medium">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    +2.1% vs last month
                                </span>
                            </div>
                        </div>
                        <div class="w-8 h-8 bg-accent-100 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-accent-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Total Followers -->
                <div class="flex-1 bg-surface rounded-lg shadow-card p-3 border border-border-light" style="flex: 1 1 20%; min-width: 0;">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h4 class="text-xs font-medium text-text-secondary mb-1">Total Followers</h4>
                            <p id="followersValue" class="text-lg font-bold text-text-primary mb-2">2.4M</p>
                            <div class="flex items-center">
                                <span id="followersChange" style="background:none;color:#16a34a;" class="ml-2 inline-flex items-center text-xs font-medium flex items-center">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    +8.9% vs last month
                                </span>
                            </div>
                        </div>
                        <div class="w-8 h-8 bg-secondary-100 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-secondary-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <!-- Total Posts -->
                <div class="flex-1 bg-surface rounded-lg shadow-card p-3 border border-border-light" style="flex: 1 1 20%; min-width: 0;">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h4 class="text-xs font-medium text-text-secondary mb-1">Total Posts</h4>
                            <p id="postsValue" class="text-lg font-bold text-text-primary mb-2">842</p>
                            <div class="flex items-center">
                                <span id="postsChange" style="background:none;color:#16a34a;" class="ml-2 inline-flex items-center text-xs font-medium flex items-center">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    +5.7% vs last month
                                </span>
                            </div>
                        </div>
                        <div class="w-8 h-8 bg-success-100 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-success-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <!-- Retweets (new) -->
                <div class="flex-1 bg-surface rounded-lg shadow-card p-3 border border-border-light" style="flex: 1 1 20%; min-width: 0;">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <h4 class="text-xs font-medium text-text-secondary mb-1">Retweets</h4>
                            <p id="retweetsValue" class="text-lg font-bold text-text-primary mb-2">48.2K</p>
                            <div class="flex items-center">
                                <span id="retweetsChange" style="background:none;color:#16a34a;" class="ml-2 inline-flex items-center text-xs font-medium">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M3 10h6v4l4-5-4-5v4H3v2z"/>
                                    </svg>
                                    +5.4% vs last month
                                </span>
                            </div>
                        </div>
                        <div class="w-8 h-8 bg-accent-100 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-accent-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20.77 8.19c.02.23.02.46.02.69 0 7.02-5.35 15.12-15.12 15.12A15.04 15.04 0 010 22.56a11 11 0 008.08-2.28c-3.76-.08-6.94-2.55-8.04-5.95a4.98 4.98 0 002.25-.08A4.77 4.77 0 01.92 8.54v-.06a4.78 4.78 0 002.16.6 4.78 4.78 0 01-1.48-6.38 13.6 13.6 0 009.86 5.02c-.63-2.9 1.36-5.12 3.39-5.12 1.11 0 2.13.46 2.84 1.2a9.45 9.45 0 003.02-1.15 4.76 4.76 0 01-2.09 2.63 9.55 9.55 0 002.76-.76 10.02 10.02 0 01-2.38 2.48z"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div id="performanceView">






                <!-- 4. CONTENT PERFORMANCE ANALYTICS -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <!-- Content Performance Analysis -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Content Performance Analytics</h3>
                                <p class="text-sm text-text-secondary mt-1">Engagement trends vs posting frequency</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-success-600 font-medium">↗ +15.3%</span>
                                <span class="text-xs text-text-secondary">vs last period</span>
                            </div>
                        </div>
                        <div class="relative h-64">
                            <canvas id="contentPerformanceChart" width="400" height="256"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-2 gap-4 text-center">
                            <div class="bg-accent-50 rounded-lg p-3 insight-card">
                                <p class="text-lg font-bold text-accent-800">633</p>
                                <p class="text-xs text-text-secondary">Total Posts</p>
                            </div>
                            <div class="bg-success-50 rounded-lg p-3 insight-card">
                                <p class="text-lg font-bold text-success-800">2,926</p>
                                <p class="text-xs text-text-secondary">Total Engagements</p>
                            </div>
                        </div>
                    </div>

                    <!-- Audience Engagement Patterns -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Audience Engagement Patterns</h3>
                                <p class="text-sm text-text-secondary mt-1">Optimal posting times analysis</p>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 bg-primary rounded-full pulse-animation"></div>
                                <span class="text-sm text-text-secondary">Peak Activity</span>
                            </div>
                        </div>
                        <div class="relative h-64">
                            <canvas id="engagementPatternsChart" width="400" height="256"></canvas>
                        </div>
                        <div class="mt-4 text-center">
                            <p class="text-sm text-text-secondary">Best posting times: <span class="font-medium text-primary">9AM-11AM EST</span> and <span class="font-medium text-primary">2PM-4PM EST</span></p>
                        </div>
                    </div>
                </div>
                
                <!-- X Activity Radar (by Month) -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container mt-8 mb-8">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="text-lg font-semibold text-text-primary">X Activity Radar (by Month)</h3>
                            <p class="text-sm text-text-secondary mt-1">Monthly posting patterns and engagement distribution</p>
                        </div>
                        <div>
                            <select id="xRadarYearSelect" class="appearance-none bg-surface border border-border rounded-md px-4 py-2 pr-8 text-sm font-medium text-text-primary focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                <option value="all">All Years</option>
                            </select>
                        </div>
                    </div>
                    <div class="relative h-96 flex items-center justify-center">
                        <canvas id="xActivityRadarChart" width="400" height="384"></canvas>
                    </div>
                    <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                        <p class="text-xs text-blue-700">◆ <span class="font-medium">Insight:</span> Consistent monthly activity patterns help maintain audience engagement and brand visibility</p>
                    </div>
                </div>
                
                <!-- Audience Demographics & Platform Performance (New Section) -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
                    <!-- Audience Demographics Chart -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">♦ Audience Demographics</h3>
                                <p class="text-sm text-text-secondary mt-1">Age group distribution of engaged audience</p>
                            </div>
                        </div>
                        <div class="relative h-96">
                            <canvas id="xDemographicsChart" width="400" height="384"></canvas>
                        </div>
                    </div>

                    <!-- Content Type Performance -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-text-primary">Content Type Performance</h3>
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                                    <span class="text-sm text-text-secondary">Video</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                                    <span class="text-sm text-text-secondary">Image</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                    <span class="text-sm text-text-secondary">Text</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-purple-500 rounded-full"></div>
                                    <span class="text-sm text-text-secondary">Link</span>
                                </div>
                            </div>
                        </div>
                        <div class="relative h-80">
                            <canvas id="xContentTypeChart" width="400" height="320"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-4 gap-4 text-center">
                            <div class="bg-red-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-red-800">8.1%</p>
                                <p class="text-xs text-text-secondary">Video Eng.</p>
                            </div>
                            <div class="bg-yellow-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-yellow-800">5.2%</p>
                                <p class="text-xs text-text-secondary">Image Eng.</p>
                            </div>
                            <div class="bg-blue-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-blue-800">3.4%</p>
                                <p class="text-xs text-text-secondary">Text Eng.</p>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-purple-800">4.6%</p>
                                <p class="text-xs text-text-secondary">Link Eng.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Detailed Engagement Analytics -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
                    <!-- Optimal Posting Schedule -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Optimal Posting Schedule</h3>
                                <p class="text-sm text-text-secondary mt-1">Best times for maximum engagement</p>
                            </div>
                            <div class="bg-green-50 rounded-lg px-3 py-1">
                                <span class="text-sm font-medium text-green-700">EST Timezone</span>
                            </div>
                        </div>
                        <div class="space-y-6">
                            <div>
                                <h4 class="text-sm font-medium text-text-secondary mb-3">Peak Hours (EST)</h4>
                                <div id="twitterPeakHours" class="grid grid-cols-4 gap-2 w-full">
                                    <!-- Peak hours will be loaded here by JS -->
                                </div>
                            </div>
                            <div class="mt-4 p-3 bg-green-50 rounded-lg">
                                <p class="text-xs text-green-700">⏰ <span class="font-medium">Best Times:</span> Schedule posts during highlighted peak hours for maximum visibility</p>
                            </div>
                        </div>
                    </div>

                    <!-- Top Performing Hashtags -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Top Performing Hashtags</h3>
                                <p class="text-sm text-text-secondary mt-1">Most effective hashtags for reach</p>
                            </div>
                            <div class="bg-primary-50 rounded-lg px-3 py-1">
                                <span class="text-sm font-medium text-primary">Trending</span>
                            </div>
                        </div>
                        <div id="twitterHashtags" class="space-y-4">
                            <!-- Hashtags will be loaded here by JS -->
                        </div>
                        <!-- Tip removed as requested -->
                    </div>
                </div>

                <!-- Second Row: Engagement Distribution and Posting Frequency -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-8">
                    <!-- Engagement Distribution Analysis -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="text-lg font-semibold text-text-primary">Engagement Distribution Analysis</h3>
                                <p class="text-sm text-text-secondary mt-1">Breakdown of user interactions</p>
                            </div>
                        </div>
                        
                        <!-- Twitter Engagement Symbols -->
                        <div class="space-y-6">
                            <!-- Likes -->
                            <div class="flex items-center justify-between bg-red-50 rounded-lg p-4 border border-red-200">
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center justify-center w-12 h-12 bg-red-100 rounded-full">
                                        <!-- Heart/Like Icon -->
                                        <svg class="w-6 h-6 text-red-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-semibold text-red-700">Likes</h4>
                                        <p class="text-sm text-red-600">Total hearts received</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p id="twitterLikesCount" class="text-2xl font-bold text-red-700">1,842</p>
                                    <p class="text-sm text-red-600">↗ +12.5%</p>
                                </div>
                            </div>

                            <!-- Retweets -->
                            <div class="flex items-center justify-between bg-green-50 rounded-lg p-4 border border-green-200">
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center justify-center w-12 h-12 bg-green-100 rounded-full">
                                        <!-- Retweet Icon -->
                                        <svg class="w-6 h-6 text-green-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M23.77 15.67c-.292-.293-.767-.293-1.06 0l-2.22 2.22V7.65c0-2.068-1.683-3.75-3.75-3.75h-5.85c-.414 0-.75.336-.75.75s.336.75.75.75h5.85c1.24 0 2.25 1.01 2.25 2.25v10.24l-2.22-2.22c-.293-.293-.768-.293-1.061 0s-.293.768 0 1.061l3.5 3.5c.145.147.337.22.53.22s.385-.073.53-.22l3.5-3.5c.294-.293.294-.767.001-1.06zM3.5 16.44c.192 0 .384-.073.53-.22l3.5-3.5c.293-.293.293-.768 0-1.061s-.767-.293-1.06 0l-2.22 2.22V3.65c0-1.24 1.01-2.25 2.25-2.25h5.85c.414 0 .75-.336.75-.75s-.336-.75-.75-.75H6.5C4.432 0 2.75 1.68 2.75 3.75V13.9l-2.22-2.22c-.293-.293-.768-.293-1.061 0s-.293.768 0 1.061l3.5 3.5c.146.147.338.22.531.22z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-semibold text-green-700">Retweets</h4>
                                        <p class="text-sm text-green-600">Content reshared</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p id="twitterRetweetsCount" class="text-2xl font-bold text-green-700">567</p>
                                    <p class="text-sm text-green-600">↗ +8.3%</p>
                                </div>
                            </div>

                            <!-- Replies -->
                            <div class="flex items-center justify-between bg-blue-50 rounded-lg p-4 border border-blue-200">
                                <div class="flex items-center space-x-4">
                                    <div class="flex items-center justify-center w-12 h-12 bg-blue-100 rounded-full">
                                        <!-- Reply Icon -->
                                        <svg class="w-6 h-6 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M14.046 2.242l-4.148-.01h-.002c-4.374 0-7.8 3.427-7.8 7.802 0 4.098 3.186 7.206 7.465 7.37v3.828c0 .108.044.286.12.403.142.225.384.347.632.347.138 0 .277-.038.402-.118.264-.168 6.473-4.14 8.088-5.506 1.902-1.61 3.04-3.97 3.043-6.312v-.017c-.006-4.367-3.43-7.787-7.8-7.788zm3.787 12.972c-1.134.96-4.862 3.405-6.772 4.643V16.67c0-.414-.335-.75-.75-.75h-.396c-3.66 0-6.318-2.476-6.318-5.886 0-3.534 2.768-6.302 6.3-6.302l4.147.01h.002c3.532 0 6.3 2.766 6.302 6.296-.003 1.91-.942 3.844-2.514 5.176z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-semibold text-blue-700">Replies</h4>
                                        <p class="text-sm text-blue-600">Conversations started</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p id="twitterRepliesCount" class="text-2xl font-bold text-blue-700">293</p>
                                    <p class="text-sm text-blue-600">↗ +15.7%</p>
                                </div>
                            </div>
                        </div>

                        <!-- Summary Stats -->
                        <div class="mt-6 bg-gray-50 rounded-lg p-4">
                            <div class="grid grid-cols-3 gap-4 text-center">
                                <div>
                                    <p class="text-sm text-gray-600">Total Engagements</p>
                                    <p class="text-xl font-bold text-gray-800">2,702</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">Engagement Rate</p>
                                    <p class="text-xl font-bold text-gray-800">4.27%</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600">Avg per Post</p>
                                    <p class="text-xl font-bold text-gray-800">8.5</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Posting Frequency Analysis -->
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-semibold text-text-primary">Posting Frequency Analysis</h3>
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                                    <span class="text-sm text-text-secondary">Daily Posts</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                                    <span class="text-sm text-text-secondary">Engagement Rate</span>
                                </div>
                            </div>
                        </div>
                        <div class="relative h-80">
                            <canvas id="xPostingFrequencyChart" width="400" height="320"></canvas>
                        </div>
                        <div class="mt-4 grid grid-cols-3 gap-4 text-center">
                            <div class="bg-blue-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-blue-800">3.1</p>
                                <p class="text-xs text-text-secondary">Avg Posts/Day</p>
                            </div>
                            <div class="bg-green-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-green-800">5.6%</p>
                                <p class="text-xs text-text-secondary">Avg Engagement</p>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-3">
                                <p class="text-lg font-bold text-purple-800">Thu</p>
                                <p class="text-xs text-text-secondary">Best Day</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Strategic Insights & Recommendations (Moved to End) -->
            <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light chart-container mb-6" style="margin-top: 1.5rem;">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold text-text-primary">Strategic Insights & Recommendations</h2>
                    <div class="bg-gradient-to-r from-primary-50 to-primary-100 rounded-lg px-4 py-2">
                        <span class="text-sm font-bold text-primary">Executive Summary</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Key Insights -->
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-4">Key Performance Insights</h3>
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3 p-4 bg-green-50 rounded-lg border border-green-200 insight-card">
                                <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                <div>
                                    <h4 class="font-medium text-green-800">Strong Positive Sentiment</h4>
                                    <p class="text-sm text-green-700">60.7% positive sentiment indicates strong brand perception on X platform</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3 p-4 bg-blue-50 rounded-lg border border-blue-200 insight-card">
                                <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                                <div>
                                    <h4 class="font-medium text-blue-800">Consistent Growth</h4>
                                    <p class="text-sm text-blue-700">10.7% growth rate demonstrates expanding audience reach and engagement</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3 p-4 bg-purple-50 rounded-lg border border-purple-200 insight-card">
                                <div class="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                                <div>
                                    <h4 class="font-medium text-purple-800">Optimal Posting Strategy</h4>
                                    <p class="text-sm text-purple-700">25.3 posts per month with high consistency maintains audience engagement</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3 p-4 bg-orange-50 rounded-lg border border-orange-200 insight-card">
                                <div class="w-2 h-2 bg-orange-500 rounded-full mt-2"></div>
                                <div>
                                    <h4 class="font-medium text-orange-800">Engagement Quality</h4>
                                    <p class="text-sm text-orange-700">4.62 average engagement per post indicates high-quality content resonance</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Strategic Recommendations -->
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-4">Strategic Recommendations</h3>
                        <div class="space-y-4">
                            <div class="flex items-start space-x-3 p-4 bg-gradient-to-r from-primary-50 to-primary-100 rounded-lg border border-primary-200 insight-card">
                                <div class="w-6 h-6 bg-primary-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                    <span class="text-white text-xs font-bold">1</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-primary-800">Amplify Positive Momentum</h4>
                                    <p class="text-sm text-primary-700">Leverage strong positive sentiment by increasing content frequency during peak engagement periods</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3 p-4 bg-gradient-to-r from-green-50 to-green-100 rounded-lg border border-green-200 insight-card">
                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                    <span class="text-white text-xs font-bold">2</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-green-800">Optimize Posting Times</h4>
                                    <p class="text-sm text-green-700">Focus on 9AM-11AM and 2PM-4PM EST windows for maximum reach and engagement</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3 p-4 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg border border-blue-200 insight-card">
                                <div class="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                    <span class="text-white text-xs font-bold">3</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-blue-800">Content Diversification</h4>
                                    <p class="text-sm text-blue-700">Experiment with video content and interactive posts to boost engagement rates further</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start space-x-3 p-4 bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg border border-purple-200 insight-card">
                                <div class="w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                    <span class="text-white text-xs font-bold">4</span>
                                </div>
                                <div>
                                    <h4 class="font-medium text-purple-800">Monitor Sentiment Shifts</h4>
                                    <p class="text-sm text-purple-700">Set up real-time alerts for significant sentiment changes to enable rapid response</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="trendsView" class="hidden">
                <!-- X Trends Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-text-secondary">Trend Direction</p>
                                <p class="text-2xl font-bold text-success-600 mt-1" id="trendDirection">↗ Positive</p>
                            </div>
                            <div class="w-12 h-12 bg-success-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-success-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M7 14l5-5 5 5z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-text-secondary">Peak Volume</p>
                                <p class="text-2xl font-bold text-text-primary mt-1" id="peakVolume">-</p>
                                
                                <p class="text-sm text-text-secondary mt-1" id="peakDate">-</p>
                            </div>
                            <div class="w-12 h-12 bg-accent-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-accent-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-text-secondary">Avg Sentiment</p>
                                <p class="text-2xl font-bold text-text-primary mt-1" id="avgSentiment">-</p>
                                <p class="text-sm text-text-secondary mt-1">Positive overall</p>
                            </div>
                            <div class="w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-primary-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-text-secondary">Volatility Index</p>
                                <p class="text-2xl font-bold text-warning-500 mt-1" id="volatilityIndex">-</p>
                                <p class="text-sm text-text-secondary mt-1">Â±12.3% variance</p>
                            </div>
                            <div class="w-12 h-12 bg-warning-100 rounded-lg flex items-center justify-center">
                                <svg class="w-6 h-6 text-warning-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Key Insights & Patterns Section -->
                <div class="bg-surface rounded-lg shadow-card p-6 border border-border-light mb-6">
                    <h2 class="text-2xl font-bold text-text-primary mb-4">Key Insights & Patterns</h2>
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-text-primary mb-2">Trending Patterns</h3>
                        <ul class="space-y-2">
                            <li class="flex items-start space-x-2">
                                <span class="inline-block w-3 h-3 rounded-full bg-green-500 mt-1"></span>
                                <div>
                                    <span class="font-medium">Positive sentiment surge in Q4 2024</span><br/>
                                    <span class="text-text-secondary">+18% increase following product announcements</span>
                                </div>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="inline-block w-3 h-3 rounded-full bg-yellow-500 mt-1"></span>
                                <div>
                                    <span class="font-medium">Seasonal engagement patterns</span><br/>
                                    <span class="text-text-secondary">Higher activity during earnings seasons</span>
                                </div>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="inline-block w-3 h-3 rounded-full bg-blue-500 mt-1"></span>
                                <div>
                                    <span class="font-medium">Platform-specific trends</span><br/>
                                    <span class="text-text-secondary">Reddit shows highest engagement volatility</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-text-primary mb-2">Strategic Recommendations</h3>
                        <ul class="space-y-2">
                            <li class="flex items-start space-x-2">
                                <span class="inline-block w-3 h-3 rounded-full bg-orange-500 mt-1"></span>
                                <div>
                                    <span class="font-medium">Capitalize on positive momentum</span><br/>
                                    <span class="text-text-secondary">Increase content frequency during peak periods</span>
                                </div>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="inline-block w-3 h-3 rounded-full bg-orange-500 mt-1"></span>
                                <div>
                                    <span class="font-medium">Monitor volatility indicators</span><br/>
                                    <span class="text-text-secondary">Set up alerts for significant sentiment shifts</span>
                                </div>
                            </li>
                            <li class="flex items-start space-x-2">
                                <span class="inline-block w-3 h-3 rounded-full bg-orange-500 mt-1"></span>
                                <div>
                                    <span class="font-medium">Platform-specific strategies</span><br/>
                                    <span class="text-text-secondary">Tailor content approach for each platform</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- Real-time Update Indicator -->
                <div class="mt-6 flex items-center justify-center">
                    <div class="flex items-center space-x-2 text-sm text-text-secondary">
                        <div class="w-2 h-2 bg-success-600 rounded-full animate-pulse"></div>
                        <span id="lastUpdatedTime">Last updated: 3 minutes ago</span>
                        <button class="text-primary hover:text-primary-600 font-medium transition-fast" onclick="loadXTrendsData()">Refresh</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

<!-- Chart.js and Twitter Trends Chart Script at the end of body -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
console.log('Script loaded!');

// --- Twitter Trends Chart with 6m/1y/2y slider ---
let twitterTrendsChart = null;
const twitterTrendsData = {
  '6m': {
    labels: ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    positive: [40, 42, 41, 43, 44, 45],
    neutral: [45, 44, 43, 42, 41, 40],
    negative: [15, 14, 16, 15, 15, 15]
  },
  '1y': {
    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    positive: [41, 42, 43, 44, 45, 44, 46, 47, 45, 44, 46, 47],
    neutral: [43, 42, 41, 40, 39, 40, 38, 37, 39, 40, 38, 37],
    negative: [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]
  },
  '2y': {
    labels: [
      'Jan 23', 'Feb 23', 'Mar 23', 'Apr 23', 'May 23', 'Jun 23',
      'Jul 23', 'Aug 23', 'Sep 23', 'Oct 23', 'Nov 23', 'Dec 23',
      'Jan 24', 'Feb 24', 'Mar 24', 'Apr 24', 'May 24', 'Jun 24',
      'Jul 24', 'Aug 24', 'Sep 24', 'Oct 24', 'Nov 24', 'Dec 24'
    ],
    positive: [41, 42, 43, 44, 45, 44, 46, 47, 45, 44, 46, 47, 45, 45, 46, 47, 45, 44, 46, 47, 45, 45, 46, 47],
    neutral: [43, 42, 41, 40, 39, 40, 38, 37, 39, 40, 38, 37, 39, 39, 38, 37, 39, 40, 38, 37, 39, 39, 38, 37],
    negative: [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]
  }
};

function initializeTwitterTrendsChart(range = '1y') {
  const ctx = document.getElementById('twitterTrendsChart');
  if (!ctx) return;
  const data = twitterTrendsData[range];
  console.log('Twitter Trends Chart Data:', data);
  if (twitterTrendsChart) twitterTrendsChart.destroy();
  twitterTrendsChart = new Chart(ctx.getContext('2d'), {
    type: 'line',
    data: {
      labels: data.labels,
      datasets: [
        { label: 'Positive', data: data.positive, borderColor: '#27AE60', backgroundColor: 'rgba(39, 174, 96, 0.1)', borderWidth: 3, fill: true, tension: 0.4 },
        { label: 'Neutral', data: data.neutral, borderColor: '#F39C12', backgroundColor: 'rgba(243, 156, 18, 0.1)', borderWidth: 3, fill: true, tension: 0.4 },
        { label: 'Negative', data: data.negative, borderColor: '#E74C3C', backgroundColor: 'rgba(231, 76, 60, 0.1)', borderWidth: 3, fill: true, tension: 0.4 }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        x: { grid: { display: true, color: '#F3F4F6' }, ticks: { font: { size: 12 } } },
        y: { beginAtZero: true, max: 100, grid: { display: true, color: '#F3F4F6' }, ticks: { font: { size: 12 }, callback: function(value) { return value + '%'; } } }
      }
    }
  });
}

const twitterRangeToSubtitle = {
  '6m': 'X (Twitter) - Last 6 Months',
  '1y': 'X (Twitter) - Last 12 Months',
  '2y': 'X (Twitter) - Last 24 Months'
};
function updateTwitterTrendsSubtitle(rangeKey) {
  const subtitle = document.getElementById('twitterTrendsSubtitle');
  if (subtitle) {
    subtitle.textContent = twitterRangeToSubtitle[rangeKey];
  }
}

const twitterSliderValueToRange = { 0: '6m', 1: '1y', 2: '2y' };
const twitterSliderValueToLabel = { 0: '6m', 1: '1y', 2: '2y' };

document.addEventListener('DOMContentLoaded', function() {
  const twitterTrendRangeSlider = document.getElementById('twitterTrendRangeSlider');
  const twitterSliderRangeBadge = document.getElementById('twitterSliderRangeBadge');
  if (twitterTrendRangeSlider && twitterSliderRangeBadge) {
    twitterTrendRangeSlider.addEventListener('input', function() {
      const label = twitterSliderValueToLabel[this.value];
      twitterSliderRangeBadge.textContent = label;
      const rangeKey = twitterSliderValueToRange[this.value];
      initializeTwitterTrendsChart(rangeKey);
      updateTwitterTrendsSubtitle(rangeKey);
      document.getElementById('twitterSliderLabel6m').style.color = this.value == 0 ? '#ff7300' : '#6B7280';
      document.getElementById('twitterSliderLabel2y').style.color = this.value == 2 ? '#ff7300' : '#6B7280';
    });
    twitterSliderRangeBadge.textContent = twitterSliderValueToLabel[twitterTrendRangeSlider.value];
    document.getElementById('twitterSliderLabel6m').style.color = twitterTrendRangeSlider.value == 0 ? '#ff7300' : '#6B7280';
    document.getElementById('twitterSliderLabel2y').style.color = twitterTrendRangeSlider.value == 2 ? '#ff7300' : '#6B7280';
    const initialRangeKey = twitterSliderValueToRange[twitterTrendRangeSlider.value];
    initializeTwitterTrendsChart(initialRangeKey);
    updateTwitterTrendsSubtitle(initialRangeKey);
  } else {
    initializeTwitterTrendsChart('1y');
    updateTwitterTrendsSubtitle('1y');
  }
});
</script>
    <script>
    console.log('Script loaded!');
    // At the very end of the script block, after all function definitions:
    if (typeof initializeTwitterTrendsChart === 'function') {
      initializeTwitterTrendsChart('1y');
      if (typeof updateTwitterTrendsSubtitle === 'function') {
        updateTwitterTrendsSubtitle('1y');
      }
    }
    const showEngagement = document.getElementById('showEngagement');
    const showTrends = document.getElementById('showTrends');
    const performanceView = document.getElementById('performanceView');
    const trendsView = document.getElementById('trendsView');
    if (showEngagement && showTrends && performanceView && trendsView) {
        showEngagement.onclick = function() {
            performanceView.classList.remove('hidden');
            trendsView.classList.add('hidden');
            showEngagement.classList.add('bg-primary', 'text-white');
            showEngagement.classList.remove('text-primary', 'border-2', 'border-primary');
            showTrends.classList.remove('bg-primary', 'text-white');
            showTrends.classList.add('text-primary', 'border-2', 'border-primary');
        };
        showTrends.onclick = function() {
            trendsView.classList.remove('hidden');
            performanceView.classList.add('hidden');
            showTrends.classList.add('bg-primary', 'text-white');
            showTrends.classList.remove('text-primary', 'border-2', 'border-primary');
            showEngagement.classList.remove('bg-primary', 'text-white');
            showEngagement.classList.add('text-primary', 'border-2', 'border-primary');
        };
        // Set Performance as default
        performanceView.classList.remove('hidden');
        trendsView.classList.add('hidden');
        showEngagement.classList.add('bg-primary', 'text-white');
        showEngagement.classList.remove('text-primary', 'border-2', 'border-primary');
        showTrends.classList.remove('bg-primary', 'text-white');
        showTrends.classList.add('text-primary', 'border-2', 'border-primary');
    }
    </script>
    <script>
// --- X (Twitter) Engagement Chart Logic (from audience_insights.html) ---
let twitterRadarChart = null;
let twitterHistogramChart = null;
let twitterBarChart = null;
let xActivityRadarChart = null;
let xBarChart = null;
let xActivityRadarRawData = null;
let sentimentPieChart = null;
let contentPerformanceChart = null;
let engagementPatternsChart = null;
let xDemographicsChart = null;
let xPostingFrequencyChart = null;
let xContentTypeChart = null;

// New chart functions for enhanced platform analysis
function initializeSentimentPieChart() {
    const ctx = document.getElementById('sentimentPieChart');
    if (!ctx) return;
    
    if (sentimentPieChart) sentimentPieChart.destroy();
    
    sentimentPieChart = new Chart(ctx.getContext('2d'), {
        type: 'doughnut',
        data: {
            labels: ['Positive', 'Neutral', 'Negative'],
            datasets: [{
                data: [60.7, 30.8, 8.5],
                backgroundColor: ['#27AE60', '#F39C12', '#E74C3C'],
                borderColor: ['#229954', '#E67E22', '#C0392B'],
                borderWidth: 2,
                hoverOffset: 10
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        padding: 20,
                        usePointStyle: true,
                        font: { size: 14, weight: 'bold' }
                    }
                },
                tooltip: {
                    backgroundColor: '#1F2937',
                    titleColor: '#FFFFFF',
                    bodyColor: '#FFFFFF',
                    callbacks: {
                        label: function(context) {
                            return `${context.label}: ${context.parsed}%`;
                        }
                    }
                }
            },
            cutout: '60%',
            animation: {
                animateRotate: true,
                duration: 1500
            }
        }
    });
}

// Initialize X Bar Chart (Yearly Sentiment Analysis)
function initializeXBarChart() {
    const ctx = document.getElementById('xBarChart');
    if (!ctx) return;
    
    const years = ['2022', '2023', '2024'];
    const positiveData = [58.3, 59.5, 60.7];
    const neutralData = [33.2, 32.0, 30.8];
    const negativeData = [8.5, 8.5, 8.5];
    
    if (xBarChart) xBarChart.destroy();
    xBarChart = new Chart(ctx.getContext('2d'), {
        type: 'bar',
        data: {
            labels: years,
            datasets: [
                { label: 'Positive', data: positiveData, backgroundColor: '#27AE60', borderRadius: 4 },
                { label: 'Neutral', data: neutralData, backgroundColor: '#F39C12', borderRadius: 4 },
                { label: 'Negative', data: negativeData, backgroundColor: '#E74C3C', borderRadius: 4 }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { position: 'top', labels: { usePointStyle: true, padding: 20 } }
            },
            scales: {
                x: { grid: { display: false }, ticks: { font: { size: 12 } } },
                y: {
                    beginAtZero: true,
                    grid: { color: '#F3F4F6' },
                    ticks: { font: { size: 12 }, callback: function(value) { return value + '%'; } },
                    max: 100
                }
            }
        }
    });
}

function initializeContentPerformanceChart() {
    const ctx = document.getElementById('contentPerformanceChart');
    if (!ctx) return;
    
    if (contentPerformanceChart) contentPerformanceChart.destroy();
    
    const weeks = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
    const engagementData = [4.2, 4.8, 4.5, 5.1];
    const postsData = [6, 7, 5, 8];
    
    contentPerformanceChart = new Chart(ctx.getContext('2d'), {
        type: 'line',
        data: {
            labels: weeks,
            datasets: [
                {
                    label: 'Avg Engagement',
                    data: engagementData,
                    borderColor: '#3498DB',
                    backgroundColor: 'rgba(52, 152, 219, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    yAxisID: 'y'
                },
                {
                    label: 'Posts Published',
                    data: postsData,
                    borderColor: '#E67E22',
                    backgroundColor: 'rgba(230, 126, 34, 0.1)',
                    borderWidth: 3,
                    fill: false,
                    tension: 0.4,
                    yAxisID: 'y1'
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                mode: 'index',
                intersect: false
            },
            plugins: {
                legend: {
                    position: 'top',
                    labels: { usePointStyle: true }
                }
            },
            scales: {
                x: {
                    grid: { display: true, color: '#F3F4F6' }
                },
                y: {
                    type: 'linear',
                    display: true,
                    position: 'left',
                    title: { display: true, text: 'Engagement Rate' },
                    grid: { color: '#F3F4F6' }
                },
                y1: {
                    type: 'linear',
                    display: true,
                    position: 'right',
                    title: { display: true, text: 'Posts Count' },
                    grid: { drawOnChartArea: false }
                }
            }
        }
    });
}

function initializeEngagementPatternsChart() {
    const ctx = document.getElementById('engagementPatternsChart');
    if (!ctx) return;
    
    if (engagementPatternsChart) engagementPatternsChart.destroy();
    
    const hours = ['6AM', '9AM', '12PM', '3PM', '6PM', '9PM'];
    const engagementRates = [15, 85, 45, 80, 35, 25];
    
    engagementPatternsChart = new Chart(ctx.getContext('2d'), {
        type: 'bar',
        data: {
            labels: hours,
            datasets: [{
                label: 'Engagement Rate (%)',
                data: engagementRates,
                backgroundColor: [
                    '#FF6B35',
                    '#27AE60',
                    '#F39C12',
                    '#27AE60',
                    '#E67E22',
                    '#E74C3C'
                ],
                borderColor: [
                    '#E55A2B',
                    '#229954',
                    '#E67E22',
                    '#229954',
                    '#D68910',
                    '#C0392B'
                ],
                borderWidth: 2,
                borderRadius: 6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: '#1F2937',
                    titleColor: '#FFFFFF',
                    bodyColor: '#FFFFFF',
                    callbacks: {
                        label: function(context) {
                            return `Engagement: ${context.parsed.y}%`;
                        }
                    }
                }
            },
            scales: {
                x: {
                    grid: { display: false },
                    ticks: { font: { weight: 'bold' } }
                },
                y: {
                    beginAtZero: true,
                    max: 100,
                    grid: { color: '#F3F4F6' },
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }
            }
        }
    });
}

// Initialize X Demographics Chart
function initializeXDemographicsChart() {
    const ctx = document.getElementById('xDemographicsChart');
    if (!ctx) return;
    if (xDemographicsChart) xDemographicsChart.destroy();
    const labels = ['18-24', '25-34', '35-44', '45-54', '55+'];
    const data = [18, 34, 30, 12, 6];
    const colors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6'];
    xDemographicsChart = new Chart(ctx.getContext('2d'), {
        type: 'doughnut',
        data: { labels, datasets: [{ data, backgroundColor: colors, borderWidth: 2, borderColor: '#FFFFFF' }] },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, padding: 15 } } } }
    });
}

// Initialize X Posting Frequency Chart
function initializeXPostingFrequencyChart() {
    const ctx = document.getElementById('xPostingFrequencyChart');
    if (!ctx) return;
    if (xPostingFrequencyChart) xPostingFrequencyChart.destroy();
    xPostingFrequencyChart = new Chart(ctx.getContext('2d'), {
        type: 'line',
        data: {
            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
            datasets: [
                { label: 'Daily Posts', data: [2.5, 2.9, 3.8, 4.2, 3.6, 1.8, 1.4], borderColor: '#3B82F6', backgroundColor: 'rgba(59,130,246,0.1)', tension: 0.4, yAxisID: 'y' },
                { label: 'Engagement Rate (%)', data: [4.8, 5.2, 6.1, 6.5, 5.9, 4.0, 3.6], borderColor: '#10B981', backgroundColor: 'rgba(16,185,129,0.1)', tension: 0.4, yAxisID: 'y1' }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { position: 'top' } },
            scales: {
                y: { type: 'linear', position: 'left', title: { display: true, text: 'Number of Posts' } },
                y1: { type: 'linear', position: 'right', title: { display: true, text: 'Engagement Rate (%)' }, grid: { drawOnChartArea: false } }
            }
        }
    });
}

// Initialize X Content Type Chart
function initializeXContentTypeChart() {
    const ctx = document.getElementById('xContentTypeChart');
    if (!ctx) return;
    if (xContentTypeChart) xContentTypeChart.destroy();
    xContentTypeChart = new Chart(ctx.getContext('2d'), {
        type: 'doughnut',
        data: {
            labels: ['Video Posts', 'Image Posts', 'Text Posts', 'Link Posts'],
            datasets: [{
                data: [32, 30, 20, 18],
                backgroundColor: ['#EF4444', '#F59E0B', '#3B82F6', '#8B5CF6'],
                borderWidth: 2,
                borderColor: '#ffffff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { position: 'bottom', labels: { padding: 20, usePointStyle: true } },
                tooltip: { callbacks: { label: function(ctx){ return ctx.label + ': ' + ctx.parsed + '%'; } } }
            }
        }
    });
}

async function loadTwitterTopHashtags() {
    try {
        const response = await fetch('../public/twitter_top_hashtags.json');
        if (!response.ok) throw new Error('Failed to load twitter_top_hashtags.json');
        const data = await response.json();
        const container = document.getElementById('twitterHashtags');
        if (!container) return;
        container.innerHTML = '';
        if (!Array.isArray(data) || data.length === 0) {
            container.innerHTML = '<div class="text-warning-700">No hashtag data available.</div>';
            return;
        }
        let maxCount = 0;
        data.forEach(item => { if (item.count > maxCount) maxCount = item.count; });
        data.forEach(item => {
            const widthPercent = maxCount > 0 ? Math.round((item.count / maxCount) * 100) : 0;
            container.innerHTML += `
                <div class="flex items-center justify-between">
                    <span class="text-sm font-medium text-primary">${item.hashtag}</span>
                    <div class="flex items-center space-x-2">
                        <div class="w-24 bg-secondary-100 rounded-full h-2">
                            <div class="bg-primary h-2 rounded-full" style="width: ${widthPercent}%"></div>
                        </div>
                        <span class="text-sm font-medium text-text-primary">${item.count.toLocaleString ? item.count.toLocaleString() : item.count}</span>
                    </div>
                </div>
            `;
        });
    } catch (e) {
        const container = document.getElementById('twitterHashtags');
        if (container) container.innerHTML = '<div class="text-warning-700">Unable to load Twitter hashtag data.</div>';
    }
}
async function loadTwitterRadarChart() {
    try {
        const response = await fetch('../public/twitter_peak_hours.json');
        if (!response.ok) throw new Error('Failed to load twitter_peak_hours.json');
        const data = await response.json();
        const labels = data.peak_hours.map(slot => slot.slot);
        const values = data.peak_hours.map(slot => slot.count);
        const ctx = document.getElementById('twitterRadarChart');
        if (!ctx) return;
        if (twitterRadarChart) twitterRadarChart.destroy();
        twitterRadarChart = new Chart(ctx.getContext('2d'), {
            type: 'radar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Mentions by Time Slot',
                    data: values,
                    fill: true,
                    backgroundColor: 'rgba(52, 152, 219, 0.2)',
                    borderColor: '#3498DB',
                    pointBackgroundColor: '#FF6B35',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#FF6B35',
                    borderWidth: 3,
                    pointRadius: 6,
                    pointHoverRadius: 9
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                        labels: { color: '#374151', font: { size: 16, weight: 'bold' } }
                    },
                    tooltip: {
                        enabled: true,
                        backgroundColor: '#1F2937',
                        titleColor: '#FFFFFF',
                        bodyColor: '#FFFFFF',
                        borderColor: '#374151',
                        borderWidth: 1,
                        cornerRadius: 8,
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.formattedValue} mentions`;
                            }
                        }
                    }
                },
                scales: {
                    r: {
                        angleLines: { color: '#E5E7EB' },
                        grid: { color: '#E5E7EB' },
                        pointLabels: { color: '#374151', font: { size: 14, weight: 'bold' } },
                        ticks: {
                            color: '#6B7280',
                            font: { size: 12 },
                            backdropColor: 'transparent',
                            callback: function(value) { return value % 1 === 0 ? value : null; }
                        },
                        min: 0
                    }
                },
                animation: { duration: 1200, easing: 'easeInOutQuart' },
                interaction: { intersect: false, mode: 'nearest' }
            }
        });
    } catch (e) {
        const ctx = document.getElementById('twitterRadarChart');
        if (ctx) ctx.parentNode.innerHTML = '<div class="text-center text-warning-700">Unable to load Twitter radar chart data.</div>';
    }
}
async function loadTwitterHistogramChart() {
    try {
        const response = await fetch('../public/twitter_histogram_data.json');
        if (!response.ok) throw new Error('Failed to load twitter_histogram_data.json');
        const data = await response.json();
        const ctx = document.getElementById('twitterHistogramChart');
        if (!ctx) return;
        if (twitterHistogramChart) twitterHistogramChart.destroy();
        
        // Filter out Views data (index 1) - keep only Likes (0), Retweets (2), Replies (3)
        const filteredLabels = data.labels.filter((label, index) => index !== 1);
        const filteredData = data.data.filter((value, index) => index !== 1);
        const colors = ['#FF6B35', '#27AE60', '#F39C12']; // Adjusted colors for 3 items
        
        twitterHistogramChart = new Chart(ctx.getContext('2d'), {
            type: 'bar',
            data: {
                labels: filteredLabels,
                datasets: [{
                    label: 'Engagement Count',
                    data: filteredData,
                    backgroundColor: colors,
                    borderColor: colors.map(color => color + 'CC'),
                    borderWidth: 2,
                    borderRadius: 6,
                    borderSkipped: false,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#1F2937',
                        titleColor: '#FFFFFF',
                        bodyColor: '#FFFFFF',
                        borderColor: '#374151',
                        borderWidth: 1,
                        cornerRadius: 8,
                        displayColors: true,
                        callbacks: {
                            label: function(context) {
                                const value = context.parsed.y;
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = ((value / total) * 100).toFixed(1);
                                return `${context.label}: ${value.toLocaleString()} (${percentage}%)`;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: { display: false },
                        ticks: { font: { size: 12, weight: 'normal' }, color: '#6B7280' }
                    },
                    y: {
                        beginAtZero: true,
                        grid: { color: '#F3F4F6', drawBorder: false },
                        ticks: {
                            font: { size: 12 },
                            color: '#6B7280',
                            callback: function(value) { return value.toLocaleString(); }
                        }
                    }
                },
                animation: { duration: 1000, easing: 'easeInOutQuart' },
                interaction: { intersect: false, mode: 'index' }
            }
        });
        // Update summary cards using filtered data
        document.getElementById('twitterLikesCount').textContent = filteredData[0]?.toLocaleString() || '-';
        document.getElementById('twitterRetweetsCount').textContent = filteredData[1]?.toLocaleString() || '-';
        document.getElementById('twitterRepliesCount').textContent = filteredData[2]?.toLocaleString() || '-';
    } catch (e) {
        // fallback: clear summary cards
        document.getElementById('twitterLikesCount').textContent = '-';
        document.getElementById('twitterRetweetsCount').textContent = '-';
        document.getElementById('twitterRepliesCount').textContent = '-';
    }
}
function initializeTwitterBarChart() {
    const ctx = document.getElementById('twitterBarChart');
    if (!ctx) return;
    fetch('../public/twitter_trends.json')
        .then(response => response.json())
        .then(data => {
            const yearMap = {};
            data.labels.forEach((label, idx) => {
                const year = label.split(' ')[1];
                if (!yearMap[year]) {
                    yearMap[year] = { positive: [], neutral: [], negative: [] };
                }
                yearMap[year].positive.push(data.positive[idx]);
                yearMap[year].neutral.push(data.neutral[idx]);
                yearMap[year].negative.push(data.negative[idx]);
            });
            const years = Object.keys(yearMap);
            const positiveYearly = years.map(y => yearMap[y].positive.reduce((a, b) => a + b, 0) / yearMap[y].positive.length);
            const neutralYearly = years.map(y => yearMap[y].neutral.reduce((a, b) => a + b, 0) / yearMap[y].neutral.length);
            const negativeYearly = years.map(y => yearMap[y].negative.reduce((a, b) => a + b, 0) / yearMap[y].negative.length);
            if (twitterBarChart) twitterBarChart.destroy();
            twitterBarChart = new Chart(ctx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [
                        { label: 'Positive', data: positiveYearly, backgroundColor: '#27AE60', borderRadius: 4 },
                        { label: 'Neutral', data: neutralYearly, backgroundColor: '#F39C12', borderRadius: 4 },
                        { label: 'Negative', data: negativeYearly, backgroundColor: '#E74C3C', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { usePointStyle: true, padding: 20 } }
                    },
                    scales: {
                        x: { grid: { display: false }, ticks: { font: { size: 12 } } },
                        y: {
                            beginAtZero: true,
                            grid: { color: '#F3F4F6' },
                            ticks: { font: { size: 12 }, callback: function(value) { return value + '%'; } },
                            max: 100
                        }
                    }
                }
            });
            // Set the latest year's sentiment values in the summary below the chart
            const lastIdx = years.length - 1;
            const pos = positiveYearly[lastIdx];
            const neu = neutralYearly[lastIdx];
            const neg = negativeYearly[lastIdx];
            const posEl = document.getElementById('twitterPositive');
            const neuEl = document.getElementById('twitterNeutral');
            const negEl = document.getElementById('twitterNegative');
            if (posEl) posEl.textContent = pos ? pos.toFixed(1) + '%' : 'N/A';
            if (neuEl) neuEl.textContent = neu ? neu.toFixed(1) + '%' : 'N/A';
            if (negEl) negEl.textContent = neg ? neg.toFixed(1) + '%' : 'N/A';
        })
        .catch(error => {
            const posEl = document.getElementById('twitterPositive');
            const neuEl = document.getElementById('twitterNeutral');
            const negEl = document.getElementById('twitterNegative');
            if (posEl) posEl.textContent = 'N/A';
            if (neuEl) neuEl.textContent = 'N/A';
            if (negEl) negEl.textContent = 'N/A';
        });
}
async function loadTwitterPeakHours() {
    try {
        const response = await fetch('../public/twitter_peak_hours.json');
        if (!response.ok) throw new Error('Failed to load twitter_peak_hours.json');
        const data = await response.json();
        const container = document.getElementById('twitterPeakHours');
        if (!container) return;
        container.innerHTML = '';
        let maxCount = 0;
        data.peak_hours.forEach(slot => { if (slot.count > maxCount) maxCount = slot.count; });
        data.peak_hours.forEach(slot => {
            let bg = slot.count === maxCount ? 'bg-primary-50' : 'bg-secondary-50';
            let text = slot.count === maxCount ? 'text-primary' : 'text-text-primary';
            let level = slot.count === maxCount ? 'High' : (slot.count > 0 ? 'Medium' : 'Low');
            container.innerHTML += `<div class="text-center p-2 ${bg} rounded"><p class="text-sm font-medium ${text}">${slot.slot}</p><p class="text-xs text-text-secondary">${level} (${slot.count})</p></div>`;
        });
    } catch (e) {
        const container = document.getElementById('twitterPeakHours');
        if (container) container.innerHTML = '<div class="col-span-4 text-center text-warning-700">Unable to load Twitter peak hours data.</div>';
    }
}

async function loadXActivityRadarChart() {
    try {
        // Create dummy data for X Activity Radar
        const dummyData = {
            labels: ['Jan 2023', 'Feb 2023', 'Mar 2023', 'Apr 2023', 'May 2023', 'Jun 2023', 'Jul 2023', 'Aug 2023', 'Sep 2023', 'Oct 2023', 'Nov 2023', 'Dec 2023', 'Jan 2024', 'Feb 2024', 'Mar 2024', 'Apr 2024', 'May 2024', 'Jun 2024', 'Jul 2024', 'Aug 2024', 'Sep 2024', 'Oct 2024', 'Nov 2024', 'Dec 2024'],
            values: [2450, 2890, 3200, 2750, 3100, 2950, 3450, 3780, 3250, 3600, 3850, 4100, 3950, 4200, 4350, 4150, 4500, 4250, 4800, 4950, 4650, 4900, 5200, 5350]
        };
        
        xActivityRadarRawData = dummyData;
        const yearSelect = document.getElementById('xRadarYearSelect');
        if (yearSelect) {
            // Extract years from labels (format: 'Month YYYY')
            const years = Array.from(new Set(dummyData.labels.map(label => label.split(' ')[1])));
            yearSelect.innerHTML = '<option value="all">All Years</option>' + years.map(y => `<option value="${y}">${y}</option>`).join('');
            yearSelect.onchange = function() { renderXActivityRadarChart(this.value); };
        }
        renderXActivityRadarChart('all');
    } catch (e) {
        const ctx = document.getElementById('xActivityRadarChart');
        if (ctx) {
            ctx.parentNode.innerHTML = '<div class="text-center text-warning-700">Unable to load X Activity Radar chart data.</div>';
        }
    }
}

function renderXActivityRadarChart(selectedYear) {
    const ctx = document.getElementById('xActivityRadarChart');
    if (!ctx || !xActivityRadarRawData) return;
    if (xActivityRadarChart) xActivityRadarChart.destroy();
    
    let labels = xActivityRadarRawData.labels;
    let values = xActivityRadarRawData.values;
    if (selectedYear && selectedYear !== 'all') {
        labels = xActivityRadarRawData.labels.filter(l => l.endsWith(' ' + selectedYear));
        values = labels.map(l => {
            const idx = xActivityRadarRawData.labels.indexOf(l);
            return xActivityRadarRawData.values[idx];
        });
    }
    
    xActivityRadarChart = new Chart(ctx.getContext('2d'), {
        type: 'radar',
        data: {
            labels: labels,
            datasets: [{
                label: 'X Activity by Month',
                data: values,
                fill: true,
                backgroundColor: 'rgba(29, 161, 242, 0.2)',
                borderColor: '#1DA1F2',
                pointBackgroundColor: '#1DA1F2',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: '#1DA1F2',
                borderWidth: 3,
                pointRadius: 6,
                pointHoverRadius: 9
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'top',
                    labels: {
                        color: '#1DA1F2',
                        font: { weight: 'bold' }
                    }
                },
                tooltip: {
                    enabled: true,
                    backgroundColor: '#1F2937',
                    titleColor: '#FFFFFF',
                    bodyColor: '#FFFFFF',
                    borderColor: '#374151',
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: ${context.formattedValue} mentions`;
                        }
                    }
                }
            },
            scales: {
                r: {
                    angleLines: { color: '#E5E7EB' },
                    grid: { color: '#E5E7EB' },
                    pointLabels: { color: '#1DA1F2', font: { weight: 'bold' } },
                    ticks: { color: '#374151' }
                }
            },
            animation: {
                duration: 1200,
                easing: 'easeInOutQuart'
            },
            interaction: {
                intersect: false,
                mode: 'nearest'
            }
        }
    });
}
// On page load or Engagement tab click, load X engagement charts
function loadXEngagementCharts() {
    // Initialize new platform analysis charts
    initializeSentimentPieChart();
    initializeXBarChart();
    initializeContentPerformanceChart();
    initializeEngagementPatternsChart();
    initializeXDemographicsChart();
    initializeXPostingFrequencyChart();
    initializeXContentTypeChart();
    
    // Load existing charts
    loadTwitterTopHashtags();
    loadTwitterRadarChart();
    loadTwitterHistogramChart();
    initializeTwitterBarChart();
    loadTwitterPeakHours();
    loadXActivityRadarChart();
}
window.addEventListener('DOMContentLoaded', function() {
    // Only load if Engagement tab is visible
    const perfView = document.getElementById('performanceView');
    if (!perfView.classList.contains('hidden')) {
        loadXEngagementCharts();
    }
});
if (showEngagement) {
    showEngagement.addEventListener('click', function() {
        loadXEngagementCharts();
    });
}

// --- X (Twitter) Trends Chart Logic (from trends_analysis.html) ---
let xTrendsData = null;
let trendsChart = null;
async function loadXTrendsData() {
    try {
        const response = await fetch('../public/twitter_trends.json');
        if (!response.ok) throw new Error('Failed to load twitter_trends.json');
        xTrendsData = await response.json();
        updateXTrendsChart();
        updateXTrendsSummary();
    } catch (e) {
        document.getElementById('trendsChart').parentNode.innerHTML = '<div class="text-center text-warning-700">Unable to load X trends data.</div>';
    }
}
function updateXTrendsChart() {
    const ctx = document.getElementById('trendsChart');
    if (!ctx || !xTrendsData) return;
    if (trendsChart) trendsChart.destroy();
    trendsChart = new Chart(ctx.getContext('2d'), {
        type: 'line',
        data: {
            labels: xTrendsData.labels,
            datasets: [
                {
                    label: 'Positive',
                    data: xTrendsData.positive,
                    borderColor: '#27AE60',
                    backgroundColor: 'rgba(39, 174, 96, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#27AE60',
                    pointBorderColor: '#FFFFFF',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                },
                {
                    label: 'Neutral',
                    data: xTrendsData.neutral,
                    borderColor: '#F39C12',
                    backgroundColor: 'rgba(243, 156, 18, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#F39C12',
                    pointBorderColor: '#FFFFFF',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                },
                {
                    label: 'Negative',
                    data: xTrendsData.negative,
                    borderColor: '#E74C3C',
                    backgroundColor: 'rgba(231, 76, 60, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#E74C3C',
                    pointBorderColor: '#FFFFFF',
                    pointBorderWidth: 2,
                    pointRadius: 4,
                    pointHoverRadius: 6
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                intersect: false,
                mode: 'index'
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    titleColor: '#2C3E50',
                    bodyColor: '#2C3E50',
                    borderColor: '#E1E8ED',
                    borderWidth: 1,
                    cornerRadius: 8,
                    displayColors: true,
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: ${context.parsed.y}%`;
                        }
                    }
                }
            },
            scales: {
                x: {
                    grid: {
                        display: true,
                        color: '#F3F4F6'
                    },
                    ticks: {
                        color: '#7F8C8D',
                        font: {
                            size: 12
                        }
                    }
                },
                y: {
                    beginAtZero: true,
                    max: 100,
                    grid: {
                        display: true,
                        color: '#F3F4F6'
                    },
                    ticks: {
                        color: '#7F8C8D',
                        font: {
                            size: 12
                        },
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                }
            },
            elements: {
                point: {
                    hoverBackgroundColor: '#FFFFFF'
                }
            }
        }
    });
}
function updateXTrendsSummary() {
    if (!xTrendsData) return;
    // Trend Direction
    const trend = xTrendsData.positive.length > 1 ? xTrendsData.positive[xTrendsData.positive.length - 1] > xTrendsData.positive[xTrendsData.positive.length - 2] : true;
    const trendElement = document.getElementById('trendDirection');
    if (trendElement) {
        trendElement.textContent = trend ? '↗ Positive' : '↘ Declining';
        trendElement.className = trend ? 'text-2xl font-bold text-success-600 mt-1' : 'text-2xl font-bold text-error-500 mt-1';
    }
    // Peak Volume & Date
    const maxVolume = Math.max(...xTrendsData.positive.map((pos, i) => pos + xTrendsData.neutral[i] + xTrendsData.negative[i]));
    const maxVolumeIndex = xTrendsData.positive.map((pos, i) => pos + xTrendsData.neutral[i] + xTrendsData.negative[i]).indexOf(maxVolume);
    const peakVolumeElement = document.getElementById('peakVolume');
    const peakDateElement = document.getElementById('peakDate');
    if (peakVolumeElement && peakDateElement) {
        peakVolumeElement.textContent = Math.floor(maxVolume * 35).toLocaleString();
        peakDateElement.textContent = xTrendsData.labels[maxVolumeIndex] || 'N/A';
    }
    // Avg Sentiment
    const avgSentiment = (xTrendsData.positive.reduce((a, b) => a + b, 0) / xTrendsData.positive.length).toFixed(1);
    const avgSentimentElement = document.getElementById('avgSentiment');
    if (avgSentimentElement) {
        avgSentimentElement.textContent = avgSentiment + '%';
    }
    // Volatility
    const variance = Math.sqrt(xTrendsData.positive.reduce((a, b) => a + Math.pow(b - avgSentiment, 2), 0) / xTrendsData.positive.length);
    const volatility = variance < 15 ? 'Low' : variance < 25 ? 'Medium' : 'High';
    const volatilityElement = document.getElementById('volatilityIndex');
    if (volatilityElement) {
        volatilityElement.textContent = volatility;
        volatilityElement.className = `text-2xl font-bold mt-1 ${volatility === 'Low' ? 'text-success-600' : volatility === 'Medium' ? 'text-warning-500' : 'text-error-500'}`;
    }
}
// Only load X trends data when Trends tab is shown
if (showTrends) {
    showTrends.addEventListener('click', function() {
        loadXTrendsData();
    });
}
// Optionally, load on page load if Trends tab is default (not the case here)
    </script>
    <style>
  .active-platform {
    box-shadow: 0 0 0 4px #ff7300, 0 4px 16px rgba(255, 115, 0, 0.25);
    border-radius: 12px;
    outline: none;
    z-index: 1;
    transition: box-shadow 0.2s;
  }
  
  /* Enhanced gradient backgrounds */
  .gradient-bg-primary {
    background: linear-gradient(135deg, #3498DB 0%, #2980B9 100%);
  }
  
  .gradient-bg-success {
    background: linear-gradient(135deg, #27AE60 0%, #229954 100%);
  }
  
  .gradient-bg-warning {
    background: linear-gradient(135deg, #F39C12 0%, #E67E22 100%);
  }
  
  .gradient-bg-error {
    background: linear-gradient(135deg, #E74C3C 0%, #C0392B 100%);
  }
  
  /* Chart hover effects */
  .chart-container {
    transition: all 0.3s ease;
  }
  
  .chart-container:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  }
  
  /* Insight cards animations */
  .insight-card {
    transition: all 0.3s ease;
    animation: fadeInUp 0.6s ease-out;
  }
  
  .insight-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Performance metric cards */
  .metric-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  
  /* Pulse animation for real-time indicators */
  .pulse-animation {
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0% {
      box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7);
    }
    70% {
      box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
    }
    100% {
      box-shadow: 0 0 0 0 rgba(52, 152, 219, 0);
    }
  }
</style>
<script>
  // Highlight the active platform button based on the current page URL
  document.addEventListener('DOMContentLoaded', function() {
    const platformBtns = document.querySelectorAll('.platform-btn');
    const currentPage = window.location.pathname.split('/').pop();
    platformBtns.forEach(btn => {
      const href = btn.getAttribute('href');
      if (href && href === currentPage) {
        btn.classList.add('active-platform');
      }
    });
  });
</script>

    <script>
        // Sidebar functionality
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('sidebar');
            const sidebarTrigger = document.getElementById('sidebarTrigger');
            const mainContent = document.getElementById('mainContent');
            let sidebarTimeout;
            
            function showSidebar() {
                sidebar.style.transform = 'translateX(0)';
                mainContent.style.marginLeft = '25%';
                clearTimeout(sidebarTimeout);
            }
            
            function hideSidebar() {
                sidebarTimeout = setTimeout(() => {
                    sidebar.style.transform = 'translateX(-100%)';
                    mainContent.style.marginLeft = '0';
                }, 300);
            }
            
            // Show sidebar on hover trigger (now very narrow)
            sidebarTrigger.addEventListener('mouseenter', showSidebar);

            // Additional edge proximity detection (opens only when pointer is at extreme left <= 12px)
            let edgeArmed = true;
            document.addEventListener('mousemove', (e) => {
                if (e.clientX <= 12) {
                    if (edgeArmed && sidebar.style.transform !== 'translateX(0)') {
                        showSidebar();
                        edgeArmed = false; // prevent rapid re-trigger
                        setTimeout(()=> edgeArmed = true, 600); // re-arm after delay
                    }
                }
            });
            
            // Keep sidebar open when hovering over it
            sidebar.addEventListener('mouseenter', () => {
                clearTimeout(sidebarTimeout);
            });
            
            // Hide sidebar when leaving it
            sidebar.addEventListener('mouseleave', hideSidebar);
            
            // Date Filter Functionality
            const dateFromInput = document.getElementById('dateFrom');
            const dateToInput = document.getElementById('dateTo');
            const applyFilterBtn = document.getElementById('applyDateFilter');
            
            // Set default dates (current year)
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            const startOfYear = `${currentYear}-01-01`;
            const endOfYear = `${currentYear}-12-31`;
            
            dateFromInput.value = startOfYear;
            dateToInput.value = endOfYear;
            
            // Apply filter function
            function applyDateFilter() {
                const fromDate = dateFromInput.value;
                const toDate = dateToInput.value;
                
                if (!fromDate || !toDate) {
                    alert('Please select both FROM and TO dates');
                    return;
                }
                
                if (new Date(fromDate) > new Date(toDate)) {
                    alert('FROM date cannot be later than TO date');
                    return;
                }
                
                // Store selected dates in localStorage
                localStorage.setItem('dateFilter_from', fromDate);
                localStorage.setItem('dateFilter_to', toDate);
                
                // Update dashboard data based on selected dates
                updateDashboardData(fromDate, toDate);
                
                // Trigger storage event for real-time sync
                window.dispatchEvent(new StorageEvent('storage', {
                    key: 'dateFilter_from',
                    newValue: fromDate
                }));
                
                // Show loading state
                applyFilterBtn.innerHTML = `
                    <svg style="width: 1rem; height: 1rem; margin-right: 0.5rem; animation: spin 1s linear infinite;" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2v4l4-4h4v4l-4 4h4v4l-4-4v4h-4l4-4H8l4 4H8v-4l4 4V8L8 4h4V2z"/>
                    </svg>
                    Applying...
                `;
                applyFilterBtn.disabled = true;
                
                setTimeout(() => {
                    applyFilterBtn.innerHTML = `
                        <svg style="width: 1rem; height: 1rem; margin-right: 0.5rem;" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                        Apply
                    `;
                    applyFilterBtn.disabled = false;
                    
                    // Show success feedback
                    const originalText = applyFilterBtn.innerHTML;
                    applyFilterBtn.innerHTML = `
                        <svg style="width: 1rem; height: 1rem; margin-right: 0.5rem;" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                        </svg>
                        Applied!
                    `;
                    applyFilterBtn.style.background = '#10b981';
                    
                    setTimeout(() => {
                        applyFilterBtn.innerHTML = originalText;
                        applyFilterBtn.style.background = '#3b82f6';
                    }, 1500);
                    
                    console.log(`Date filter applied: ${fromDate} to ${toDate}`);
                }, 1000);
            }
            
            // Load saved dates function
            function loadSavedDates() {
                const savedFromDate = localStorage.getItem('dateFilter_from');
                const savedToDate = localStorage.getItem('dateFilter_to');
                
                if (savedFromDate && savedToDate) {
                    dateFromInput.value = savedFromDate;
                    dateToInput.value = savedToDate;
                }
            }

            // Dashboard data for different date scenarios
            const dashboardData = {
                currentDate: {
                    reach: "1.8M",
                    reachChange: "+12.3% vs last month",
                    performance: "4.2%",
                    engagementChange: "+2.1% vs last month",
                    followers: "2.4M",
                    followersChange: "+8.9% vs last month",
                    posts: "842",
                    postsChange: "+5.7% vs last month"
                },
                historicalData: {
                    reach: "1.5M",
                    reachChange: "+8.1% vs last month",
                    performance: "3.8%",
                    engagementChange: "+1.4% vs last month",
                    followers: "2.2M",
                    followersChange: "+6.2% vs last month",
                    posts: "798",
                    postsChange: "+3.9% vs last month"
                }
            };

            // Update badge with dynamic success/error styling based on sign
            function updateChangeBadge(elementId, changeText) {
                const el = document.getElementById(elementId);
                if (!el) return;
                const isNegative = /^\s*-/.test((changeText || '').trim());
                const bgClass = isNegative ? 'bg-error-100' : 'bg-success-100';
                const textClass = isNegative ? 'text-error-700' : 'text-success-700';
                const rotate = isNegative ? 'transform rotate-180' : '';
                const preserveMargin = el.classList.contains('ml-2');
                let className = `inline-flex items-center px-2 py-1 ${bgClass} ${textClass} text-xs font-medium rounded-full`;
                if (preserveMargin) className += ' ml-2';
                el.className = className;
                el.innerHTML = `
                    <svg class="w-3 h-3 mr-1 ${rotate}" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                    </svg>
                    ${changeText}
                `;
            }

            // Function to get current date in YYYY-MM-DD format
            function getCurrentDateString() {
                const today = new Date();
                return today.toISOString().split('T')[0];
            }

            // Function to update dashboard data based on selected dates
            function updateDashboardData(fromDate, toDate) {
                const currentDateStr = getCurrentDateString();
                const isCurrentDate = (toDate === currentDateStr);
                
                // Select appropriate data set
                const data = isCurrentDate ? dashboardData.currentDate : dashboardData.historicalData;
                
                // Update the dashboard metrics with smooth transition
                updateMetricWithAnimation('reachValue', data.reach);
                updateMetricWithAnimation('performanceValue', data.performance);
                updateMetricWithAnimation('followersValue', data.followers);
                updateMetricWithAnimation('postsValue', data.posts);
                
                // Update change indicators with dynamic color
                updateChangeBadge('reachChange', data.reachChange);
                updateChangeBadge('engagementChange', data.engagementChange);
                updateChangeBadge('followersChange', data.followersChange);
                updateChangeBadge('postsChange', data.postsChange);
                
                // Show visual feedback for data update
                const metricsContainer = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-4');
                if (metricsContainer) {
                    metricsContainer.style.opacity = '0.7';
                    setTimeout(() => {
                        metricsContainer.style.opacity = '1';
                    }, 300);
                }
                
                console.log(`Dashboard updated for date range: ${fromDate} to ${toDate} (Current date: ${isCurrentDate})`);
            }

            // Function to animate metric value changes
            function updateMetricWithAnimation(elementId, newValue) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.style.transform = 'scale(1.1)';
                    element.style.transition = 'transform 0.3s ease';
                    
                    setTimeout(() => {
                        element.textContent = newValue;
                        element.style.transform = 'scale(1)';
                    }, 150);
                }
            }

            // Initialize with current data on page load
            window.addEventListener('load', function() {
                const savedToDate = localStorage.getItem('dateFilter_to');
                if (savedToDate) {
                    updateDashboardData(localStorage.getItem('dateFilter_from') || startOfYear, savedToDate);
                } else {
                    updateDashboardData(startOfYear, endOfYear);
                }
            });
            
            // Event listeners
            applyFilterBtn.addEventListener('click', applyDateFilter);
            
            // Listen for storage changes from other tabs/windows
            window.addEventListener('storage', function(e) {
                if (e.key === 'dateFilter_from' || e.key === 'dateFilter_to') {
                    loadSavedDates();
                }
            });
            
            // Load saved filter dates on page load
            loadSavedDates();
        });
    </script>
</body>
</html> 

